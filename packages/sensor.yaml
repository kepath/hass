sensor:

  # Own public IPv4 address
  - platform: dnsip
    name: WAN IP

  - platform: launch_library

  - platform: feedparser
    name: RSS Hass Alerts
    feed_url: 'https://alerts.home-assistant.io/feed.xml'
    date_format: '%a, %b %d %I:%M %p'
    inclusions:
      - title
      - link
      - description
      - image
      - language
      - pubDate
    exclusions:
      - language

  - platform: tautulli
    name: Plex State Tautulli
    host: !secret ha_rj45_ip
    api_key: !secret tautulli_api_key

  - platform: mqtt
    name: Plex State MQTT
    state_topic: homeassistant/sensor/tautulli/all
    value_template: '{{ value_json.body }}'
    unique_id: tautulli_mqtt_status

  - platform: mqtt
    name: Zigbee2mqtt Networkmap
    # if you change base_topic of Zigbee2mqtt, change state_topic accordingly
    state_topic: zigbee2mqtt/bridge/networkmap/raw
    value_template: >-
      {{ now().strftime('%Y-%m-%d %H:%M:%S') }}
    # again, if you change base_topic of Zigbee2mqtt, change json_attributes_topic accordingly
    json_attributes_topic: zigbee2mqtt/bridge/networkmap/raw

  - platform: sql
    db_url: !secret hass_addon_mariadb_url
    queries:
    - name: HASS DB size
      query: !secret hass_addon_mariadb_size_query
      column: 'value'
      unit_of_measurement: MB

  - platform: bitcoin
    currency: GBP
    display_options:
      - exchangerate
      - trade_volume_btc


#sensors for HA updates
  - platform: command_line
    name: core_updates
    command: 'curl http://supervisor/core/info -H "Authorization: Bearer $(printenv SUPERVISOR_TOKEN)" | jq ''{"latest_version":.data.version_latest,"installed_version":.data.version,"update_available":.data.update_available}'''
    value_template: '{{ value_json.update_available }}'
    scan_interval: 600
    json_attributes:
      - update_available
      - latest_version
      - installed_version

  - platform: command_line
    name: supervisor_updates
    command: 'curl http://supervisor/supervisor/info -H "Authorization: Bearer $(printenv SUPERVISOR_TOKEN)" | jq ''{"latest_version":.data.version_latest,"installed_version":.data.version,"update_available":.data.update_available}'''
    value_template: '{{ value_json.update_available }}'
    scan_interval: 600
    json_attributes:
      - update_available
      - latest_version
      - installed_version

  - platform: command_line
    name: os_updates
    command: 'curl http://supervisor/os/info -H "Authorization: Bearer $(printenv SUPERVISOR_TOKEN)" | jq ''{"latest_version":.data.version_latest,"installed_version":.data.version,"update_available":.data.update_available}'''
    value_template: '{{ value_json.update_available }}'
    scan_interval: 600
    json_attributes:
      - update_available
      - latest_version
      - installed_version

  - platform: template
    sensors:
      date_long:
        friendly_name: 'Date and Day of week'
        value_template: >
          {% set months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"] %}
          {% set days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"] %}
          {{ months[now().month-1] }}.{{ now().day }}th. {{ days[now().weekday()] }}
---
chip_weather_with_long_date_with_dayand_time:
  template:
    - "chips"
    - "ulm_actions_card"
  variables:
    ulm_card_weather_enable_popup: false
    # ulm_language: >
    #   [[[
    #     return hass["language"];
    #   ]]]
    ulm_chip_temperature_weather:
      force_eval: true
      value: >
        [[[
          return variables.ulm_chip_temperature_weather;
        ]]]
  # triggers_update: "all"
  entity: "[[[ return variables.ulm_chip_temperature_weather ]]]"
  tap_action:
    action: "more-info"
  label: |
    [[[
      var locale = variables.ulm_language;
      let dt = new Intl.DateTimeFormat(locale , {
        month: "short",
        day: "numeric",
        hour: "numeric",
        minute: "numeric",
        weekday: "short",
        hour12: false
      });
      let formatted_date = dt.format(Date.now())
      //return formatted_date;
      var state = states[variables.ulm_chip_temperature_weather].state;
      var icon = {
        "clear-night": "ğŸŒ™",
        "cloudy": "â˜ï¸",
        "exceptional": "ğŸŒ",
        "fog": "ğŸŒ«ï¸",
        "hail": "â›ˆï¸",
        "lightning": "âš¡",
        "lightning-rainy": "â›ˆï¸",
        "partlycloudy": "â›…",
        "pouring": "ğŸŒ§ï¸",
        "rainy": "ğŸ’§",
        "snowy": "â„ï¸",
        "snowy-rainy": "ğŸŒ¨ï¸",
        "sunny": "â˜€ï¸",
        "windy": "ğŸŒªï¸",
        "default": "ğŸŒ¡ï¸"
        }
      function convertTemperature(temp) {
        if (parseFloat(temp) == temp && Math.floor(temp) != temp) {
            return parseFloat(temp).toFixed(1);
        }
        return temp;
      }
      var outside_temp = states[variables.ulm_chip_temperature_outside].state;
      var label = formatted_date + "&nbsp;&nbsp;" + (icon[state] || icon["default"]) + "&nbsp;" + convertTemperature(outside_temp) + "&#8451;";
      return label;
    ]]]

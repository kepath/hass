---
custom_card_kepath_binary_sensor_update_links:
  # template:
  #   - "icon_info_bg"
  #   - "ulm_translation_engine"
  variables:
    ulm_card_kepath_binary_sensor_update_links:
      evaluated_object: >
        [[[
          if (variables?.ulm_card_kepath_binary_sensor_update_links) {
            if (variables?.ulm_card_kepath_binary_sensor_update_links?.evaluated_object) {
              return variables.ulm_card_kepath_binary_sensor_update_links.evaluated_object;
            } else {
              return entity.entity_id;
            }
          }
        ]]]
      use_picture: >
        [[[
          var usePicture = true;
          if (variables?.ulm_card_kepath_binary_sensor_update_links) {
            if (variables?.ulm_card_kepath_binary_sensor_update_links?.use_picture) {
              if (typeof variables.ulm_card_kepath_binary_sensor_update_links.use_picture === "boolean") {
                usePicture = variables.ulm_card_kepath_binary_sensor_update_links.use_picture;
              }
            }
          }
          return usePicture;
        ]]]
  show_icon: "[[[ return variables.ulm_card_kepath_binary_sensor_update_links.use_picture ? false : true ]]]"
  show_entity_picture: "[[[ return variables.ulm_card_kepath_binary_sensor_update_links.use_picture ? true : false ]]]"
  entity_picture: >
    [[[
      var entityPicture = null;
      if (states[variables.ulm_card_kepath_binary_sensor_update_links.evaluated_object]?.attributes.entity_picture) {
        entityPicture = states[variables.ulm_card_kepath_binary_sensor_update_links.evaluated_object].attributes.entity_picture;
      }
      return entityPicture;
    ]]]
  hold_action:
    action: >
      [[[
        var holdAction = "more-info";
        if (states[variables.ulm_card_kepath_binary_sensor_update_links.evaluated_object]?.attributes.release_url) {
          holdAction = "url";
        }
        return holdAction;
      ]]]
    url_path: >
      [[[
        var URLPath = null;
        if (states[variables.ulm_card_kepath_binary_sensor_update_links.evaluated_object]?.attributes.release_url) {
          URLPath = states[variables.ulm_card_kepath_binary_sensor_update_links.evaluated_object].attributes.release_url;
        }
        return URLPath;
      ]]]
  double_tap_action:
    action: "more-info"
#   custom_fields:
#     unavailable:
#       card:
#         type: "custom:button-card"
#         template:
#           - "widget_count_indicator"
#         variables:
#           notification_counts: "[[[ return variables?.ulm_card_kepath_binary_sensor_count_notifications?.unavailable; ]]]"
#         entity: "[[[ return variables?.ulm_card_kepath_binary_sensor_count_notifications?.unavailable?.entity; ]]]"

#     amount:
#       card:
#         type: "custom:button-card"
#         template:
#           - "widget_count_indicator"
#         variables:
#           notification_counts: "[[[ return variables?.ulm_card_kepath_binary_sensor_count_notifications?.amount; ]]]"
#         entity: "[[[ return variables?.ulm_card_kepath_binary_sensor_count_notifications?.amount?.entity; ]]]"

# widget_count_indicator:
#   show_icon: true
#   show_label: false
#   show_name: false
#   group_expand: true
#   styles:
#     icon:
#       - width: "14px"
#       - height: "14px"
#       - line-height: "0"
#       - color: >
#           [[[
#             var iconColor = "rgba(var(--color-red),1)";
#             if(hass.themes.darkMode) {
#               iconColor = "rgba(var(--color-yellow),1)";
#             }
#             return iconColor;
#           ]]]
#     img_cell:
#       - border-radius: "50%"
#       - background-color: "rgba(var(--color-theme),0)"
#       - height: "16px"
#       - width: "16px"
#       - border: "2px solid rgba(var(--color-theme),0)"
#     card:
#       - height: "100%"
#       - box-shadow: "none"
#       - padding: "0"
#       - border-radius: "50%"
#   style:
#     $: >
#       .tooltip .tooltiptext {
#         display:none;
#       }

#   icon: >
#     [[[
#       var amountValue = 0;
#       var icon = "mdi:numeric-0-circle";
#       if (variables.notification_counts.is_attribute) {
#         amountValue = states[variables?.notification_counts?.entity]?.attributes[variables?.notification_counts?.attribute_name] ? states[variables.notification_counts.entity].attributes[variables.notification_counts.attribute_name] : 0;
#       } else {
#         amountValue = states[variables?.notification_counts?.entity]?.state ? states[variables.notification_counts.entity].state : 0;
#       }
#       if (!isNaN(amountValue) && amountValue !== undefined){
#         if (amountValue > 9) {
#           amountValue = "9-plus";
#         }
#         icon = icon.replace("0",amountValue);
#       }
#       if (amountValue == "on") {
#         icon = "mdi:arrow-up-bold-circle";
#       }
#       if(hass.themes.darkMode) {
#         icon = icon.replace("-circle","");
#       }
#       return icon;
#     ]]]
#   state:
#     - operator: "template"
#       value: >
#         [[[
#           var isZeroValue = true;
#           var amountValue = 0;
#           if (variables.notification_counts.is_attribute) {
#             amountValue = states[variables?.notification_counts?.entity]?.attributes[variables?.notification_counts?.attribute_name] ? states[variables.notification_counts.entity].attributes[variables.notification_counts.attribute_name] : 0;
#           } else {
#             amountValue = states[variables?.notification_counts?.entity]?.state ? states[variables.notification_counts.entity].state : 0;
#           }
#           if (!isNaN(amountValue) && amountValue != 0 && amountValue !== undefined) {
#             isZeroValue = false;
#           }
#           if (amountValue == "on") {
#             isZeroValue = false;
#           }
#           return isZeroValue;
#         ]]]
#       styles:
#         card:
#           - display: "none"
#   tooltip: >
#     [[[
#       var tooltipValue = null;
#       if(variables?.notification_counts?.count_tooltip) {
#         tooltipValue = variables.notification_counts.count_tooltip;
#       }
#       return tooltipValue;
#     ]]]

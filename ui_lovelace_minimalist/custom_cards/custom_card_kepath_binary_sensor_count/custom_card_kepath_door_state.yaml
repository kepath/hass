---
custom_card_kepath_door_state:
  variables:
    ulm_card_kepath_binary_sensor_count_notifications:
      # amount:
      #   entity: "sensor.binary_sensor_state_counts"
      #   is_attribute: >
      #     [[[
      #       var isValueAttribute = true;
      #       if (variables?.ulm_card_kepath_binary_sensor_count_notifications?.amount?.is_attribute) {
      #         if (typeof variables.ulm_card_kepath_binary_sensor_count_notifications.amount.is_attribute === "boolean") {
      #           isValueAttribute = variables.ulm_card_kepath_binary_sensor_count_notifications.amount.is_attribute;
      #         }
      #       }
      #       return isValueAttribute;
      #     ]]]
      #   attribute_name: "zero_value"
      locked:
        entity: "sensor.binary_sensor_state_counts"
        is_attribute: >
          [[[
            var isValueAttribute = true;
            if (variables?.ulm_card_kepath_binary_sensor_count_notifications?.locked?.is_attribute) {
              if (typeof variables.ulm_card_kepath_binary_sensor_count_notifications.locked.is_attribute === "boolean") {
                isValueAttribute = variables.ulm_card_kepath_binary_sensor_count_notifications.locked.is_attribute;
              }
            }
            return isValueAttribute;
          ]]]
        attribute_name: "zero_value"
  state:
    - operator: "=="
      value: "on"
      id: "on"
      icon: "mdi:door-open"
      styles:
        icon:
          - color: "rgba(var(--color-red),1)"
        img_cell:
          - background-color: "rgba(var(--color-red), 0.2)"

    - operator: "default"
      icon: >
        [[[
          var icon = "mdi:door-closed";
          if (states[variables.ulm_card_kepath_binary_sensor_count_notifications.locked.entity].attributes[variables.ulm_card_kepath_binary_sensor_count_notifications.locked.attribute_name] != "0") {
            icon = "mdi:door-closed-lock";
          }
          return icon;
        ]]]
      styles:
        icon:
          - color: "rgba(var(--color-green),1)"
        img_cell:
          - background-color: "rgba(var(--color-green), 0.2)"

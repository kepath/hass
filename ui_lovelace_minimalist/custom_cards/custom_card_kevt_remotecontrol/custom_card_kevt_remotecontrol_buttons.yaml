
########################################################
#####  BUTTON TEMPLATES                             ####
########################################################

remotecontrol_button:
  type: 'custom:button-card'
  template: widget_icon

  variables:
    button:
  remotecontrol_button_presses:
    type: 'custom:button-card'
    template: widget_icon
    variables:
      # entity: '[[[ return variables.entity ]]]'
      button_actions:  '[[[ return variables.button.actions ]]]'
        # tap:
          # entity: '[[[ return variables.button.actions.tap.entity ]]]'
          # action: '[[[ return variables.button.actions.tap.action ]]]'
          # service: '[[[ return variables.button.actions.tap.service ]]]'
          # haptic: '[[[ return variables.button.actions.tap.haptic ]]]'
        # double_tap:
          # entity: '[[[ return variables.button.actions.double_tap.entity ]]]'
          # action: '[[[ return variables.button.actions.double_tap.action ]]]'
          # service: '[[[ return variables.button.actions.double_tap.service ]]]'
          # haptic: '[[[ return variables.button.actions.double_tap.haptic ]]]'
        # hold: '[[[ return variables.button.actions.hold.entity ]]]'
          # entity: '[[[ return variables.button.actions.hold.entity ]]]'
          # action: '[[[ return variables.button.actions.hold.action ]]]'
          # service: '[[[ return variables.button.actions.hold.service ]]]'
          # haptic: '[[[ return variables.button.actions.hold.haptic ]]]'
          # repeat:
  icon: >
    [[[
      var icon = variables.button.icon.name;
      if (variables.button.type == 'play') {
        if (states[variables.button.entity].state == 'off'
            || states[variables.button.entity_id].state == 'PowerOff'
            || states[variables.button.entity_id].state == 'idle'
            || states[variables.button.entity_id].state == 'paused') {
          var icon = 'mdi:play';
        }
      }
      return icon;
    ]]]
  styles:
    icon:
      - color: '[[[ return variables.button.icon.color ]]]'
    img_cell:
      - background-color: >
          [[[
              var color = variables.button.background_color;
              if (variables.button.type == 'mute') {
                if (typeof states[variables.button.entity_id].attributes.is_volume_muted !== 'undefined') {
                  if (states[variables.button.entity_id].attributes.is_volume_muted){
                    var color = "rgba(var(--color-green), 0.2)";
                  }
                }
              }
              if (variables.button.type == 'power') {
                if (states[variables.button.entity_id].state == 'off'
                    || states[variables.button.entity_id].state == 'PowerOff') {
                  var color = variables.button.background_color;
                } else {
                  var color = "rgba(var(--color-red), 0.2)";
                }
              }
              return color;
          ]]]

remotecontrol_button_presses:
  type: 'custom:button-card'
  template: widget_icon
  variables:
    # entity:
    button_actions:
      # tap:
      #   # entity: '[[[ return variables.entity ]]]'
      #   # action: "call-service"
      #   # service:
      #   # command:
      #   # haptic: "none"
      #   # harmony:
      #   #   device:
      #   #   delay: 0.6
      # double_tap:
      #   # entity: '[[[ return variables.entity ]]]'
      #   # action: "none"
      #   # service:
      #   # command:
      #   # haptic: "none"
      #   # harmony:
      #   #   device:
      #   #   delay: 0.6
      # hold:
      #   # entity: '[[[ return variables.entity ]]]'
      #   # action: "more-info"
      #   # service:
      #   # command:
      #   # haptic: "none"
      #   # repeat:
      #   # harmony:
      #   #   device:
      #   #   delay: 0.6
  tap_action:
    remotecontrol_button_action:
      type: 'custom:button-card'
      template: widget_icon
      variables:
        button_action: '[[[ return variables.button_actions.tap ]]]'
  double_tap_action:
    remotecontrol_button_action:
      type: 'custom:button-card'
      template: widget_icon
      variables:
        button_action: '[[[ return variables.button_actions.double_tap]]]'
  hold_action:
    remotecontrol_button_action:
      type: 'custom:button-card'
      template: widget_icon
      variables:
        button_action: '[[[ return variables.button_actions.hold ]]]'

remotecontrol_button_action:
  type: 'custom:button-card'
  template: widget_icon
  variables:
    button_action:
  action: >
    {% if variables.button_action.action == "call-service" %}
      {% if variables.button_action.service.startswith("androidtv") %}
        action: call-service
        service: androidtv.adb_command
        service_data:
          command: '[[[ return variables.button_action.command ]]]'
          entity_id: '[[[ return variables.button_action.entity_id ]]]'
      {% elif variables.button_action.service.startswith("media") %}
        service: media_player.play_media
        data:
          entity_id: '[[[ return variables.button_action.entity_id ]]]'
          media_content_id: '[[[ return variables.button_action.command ]]]'
          media_content_type: "send_key"
      {% elif variables.button_action.service.startswith("remote") %}
        service: remote.send_command
        target:
          entity_id: '[[[ return variables.button_action.entity_id ]]]'
        data:
          command:
            - '[[[ return variables.button_action.command ]]]'
          device: '[[[ return variables.button_action.harmony.device ]]]'
          delay_secs: '[[[ return variables.button_action.harmony.delay ]]]'
      {% else %}
        "none"
      {% endif%}
    {% elif variables.button_action.action == "more-info" %}
      action: more-info
      entity_id: '[[[ return variables.button_action.entity_id ]]]'
    {% elif variables.button_action.action == "toggle" %}
      action: toggle
    {% elif variables.button_action.action == "navigate" %}
      action: navigate
      navigation_path: '[[[ return variables.button_action.command ]]]'
    {% elif variables.button_action.action == "url" %}
    {% else %}
      "none"
    {% endif %}
    haptic: '[[[ return variables.button_action.haptic ]]]'


##  success	Indicates that a task or action has completed.
##  warning	Indicates that a task or action has produced a warning of some kind.
##  failure	Indicates that a task or action has failed.
##  light	Provides a physical metaphor that complements the visual experience.
##  medium	Provides a physical metaphor that complements the visual experience.
##  heavy	Provides a physical metaphor that complements the visual experience.
##  selection	Indicates that the selection is actively changing.

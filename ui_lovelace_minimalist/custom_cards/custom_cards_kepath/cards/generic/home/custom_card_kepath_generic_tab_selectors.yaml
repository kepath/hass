---
custom_card_kepath_generic_tab_selectors:
  template:
    - "icon_info_bg"
    - "ulm_translation_engine"
    - "custom_card_kepath_generic_tab_selectors_input_switcher"
    - "ulm_card_kepath_constants"
    # - "generic_set_icon_and_color"
  variables:
    var_card_kepath_generic_tab_selectors_appearance:
      evaluated_object: >
        [[[
          var entity = entity.entity_id;
          if (variables?.var_card_kepath_generic_tab_selectors_appearance?.evaluated_object) {
            entity = variables.var_card_kepath_generic_tab_selectors_appearance.evaluated_object;
          }
          return entity;
        ]]]
  show_name: false
  styles:
    card:
      - border-bottom-left-radius: "0px"
      - border-bottom-right-radius: "0px"
      - padding: "12px"
      - padding-bottom: "18px"
      - margin-bottom: >
          [[[
            var marginBottom = "-5px";
            if (entity.state == "on") {
              marginBottom = "-10px";
              if (hass.themes.darkMode) {
                marginBottom = "-6px";
              }
            }
            return marginBottom;
          ]]]
      - box-shadow: >
          [[[
            var boxShadow = "none";
            if (entity.state == "on") {
              boxShadow = "rgba(0, 0, 0, 0.16) 0px -4px 7px -1px";
            }
            return boxShadow;
          ]]]
      - background-color: >
          [[[
            var BGColor = "rgba(var(--color-theme),0)";
            if (entity.state == "on") {
              BGColor = "";
            }
            return BGColor;
          ]]]

custom_card_kepath_generic_tab_selectors_input_switcher:
  tap_action:
    action: "fire-dom-event"
    browser_mod:
      service: "browser_mod.sequence"
      data:
        sequence:
          - service: "input_boolean.turn_off"
            data:
              entity_id: >
                [[[
                  const dropdown_list = variables.var_kepath_constant_tab_list;
                  for (let i = 0; i < dropdown_list.length; i++) {
                    if (dropdown_list[i] == entity.entity_id) {
                      dropdown_list.splice(i,1); //remove selected tab button
                    }
                  }
                  return dropdown_list;
                ]]]
          - service: "input_boolean.turn_on"
            data:
              entity_id: >
                [[[ return entity.entity_id ]]]

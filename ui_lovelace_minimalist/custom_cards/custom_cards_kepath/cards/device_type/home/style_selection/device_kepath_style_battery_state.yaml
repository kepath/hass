---
device_kepath_style_battery_state:
  template:
    - "ulm_gradient_green_yellow_red_battery_10step"
  state:
    - operator: "template"
      value: >
        [[[
            var attributeValue = "unknown";
            if (variables?.var_kepath_generic_get_set_group_notification_objects?.battery_value?.attribute_name) {
              attributeValue = states[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.entity].attributes[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.attribute_name];
            }
            if(attributeValue == "unknown") {
              return true;
            }
            return false;
        ]]]
      icon: "mdi:battery-unknown"
      styles:
        icon:
          - color: "rgba(var(--color-grey),1)"
        img_cell:
          - background-color: "rgba(var(--color-grey), 0.2)"

    - operator: "default"
      icon: >
        [[[
            var attributeValue = "-alert";
            if (variables?.var_kepath_generic_get_set_group_notification_objects?.battery_value?.attribute_name) {
              attributeValue = "-" + states[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.entity].attributes[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.attribute_name];
            }
            if (attributeValue == "-0") {
              attributeValue = "-outline";
            }
            if (attributeValue == "-100") {
              attributeValue = "";
            }
            if (attributeValue == undefined) {
              attributeValue = "-alert";
            }
            return "mdi:battery" + attributeValue;
        ]]]
      styles:
        icon:
          - color: >
              [[[
                  var color = "grey";
                  var attributeValue = "0";
                  if (variables?.var_kepath_generic_get_set_group_notification_objects?.battery_value?.attribute_name) {
                    attributeValue = states[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.entity].attributes[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.attribute_name];
                  }
                  var gradient = "gradient_" + attributeValue;
                  if (variables?.green_yellow_red_battery_10step?.[gradient]) {
                    color = variables?.green_yellow_red_battery_10step?.[gradient];
                  }
                  return "rgba(var(--color-"+color+"),1)";
              ]]]
        img_cell:
          - background-color: >
              [[[
                  var color = "grey";
                  var attributeValue = "0";
                  if (variables?.var_kepath_generic_get_set_group_notification_objects?.battery_value?.attribute_name) {
                    attributeValue = states[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.entity].attributes[variables.var_kepath_generic_get_set_group_notification_objects.battery_value.attribute_name];
                  }
                  var gradient = "gradient_" + attributeValue;
                  if (variables?.green_yellow_red_battery_10step?.[gradient]) {
                    color = variables?.green_yellow_red_battery_10step?.[gradient];
                  }
                  return "rgba(var(--color-"+color+"),0.2)";
              ]]]

function e(e,t,o,i){var a,r=arguments.length,n=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(n=(r<3?a(n):r>3?a(t,o,n):a(t,o))||n);return r>3&&n&&Object.defineProperty(t,o,n),n}var t,o;function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}!function(e){e.language="language",e.system="system",e.comma_decimal="comma_decimal",e.decimal_comma="decimal_comma",e.space_comma="space_comma",e.none="none"}(t||(t={})),function(e){e.language="language",e.system="system",e.am_pm="12",e.twenty_four="24"}(o||(o={}));var a=function(e,o,i){var a=o?function(e){switch(e.number_format){case t.comma_decimal:return["en-US","en"];case t.decimal_comma:return["de","es","it"];case t.space_comma:return["fr","sv","cs"];case t.system:return;default:return e.language}}(o):void 0;if(Number.isNaN=Number.isNaN||function e(t){return"number"==typeof t&&e(t)},(null==o?void 0:o.number_format)!==t.none&&!Number.isNaN(Number(e))&&Intl)try{return new Intl.NumberFormat(a,r(e,i)).format(Number(e))}catch(t){return console.error(t),new Intl.NumberFormat(void 0,r(e,i)).format(Number(e))}return"string"==typeof e?e:function(e,t){return void 0===t&&(t=2),Math.round(e*Math.pow(10,t))/Math.pow(10,t)}(e,null==i?void 0:i.maximumFractionDigits).toString()+("currency"===(null==i?void 0:i.style)?" "+i.currency:"")},r=function(e,t){var o=i({maximumFractionDigits:2},t);if("string"!=typeof e)return o;if(!t||!t.minimumFractionDigits&&!t.maximumFractionDigits){var a=e.indexOf(".")>-1?e.split(".")[1].length:0;o.minimumFractionDigits=a,o.maximumFractionDigits=a}return o};const n=window,l=n.ShadowRoot&&(void 0===n.ShadyCSS||n.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),d=new WeakMap;class c{constructor(e,t,o){if(this._$cssResult$=!0,o!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(l&&void 0===e){const o=void 0!==t&&1===t.length;o&&(e=d.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&d.set(t,e))}return e}toString(){return this.cssText}}const u=(e,...t)=>{const o=1===e.length?e[0]:t.reduce(((t,o,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+e[i+1]),e[0]);return new c(o,e,s)},v=l?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const o of e.cssRules)t+=o.cssText;return(e=>new c("string"==typeof e?e:e+"",void 0,s))(t)})(e):e;var _;const h=window,p=h.trustedTypes,y=p?p.emptyScript:"",m=h.reactiveElementPolyfillSupport,f={toAttribute(e,t){switch(t){case Boolean:e=e?y:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let o=e;switch(t){case Boolean:o=null!==e;break;case Number:o=null===e?null:Number(e);break;case Object:case Array:try{o=JSON.parse(e)}catch(e){o=null}}return o}},g=(e,t)=>t!==e&&(t==t||e==e),b={attribute:!0,type:String,converter:f,reflect:!1,hasChanged:g};class w extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,o)=>{const i=this._$Ep(o,t);void 0!==i&&(this._$Ev.set(i,o),e.push(i))})),e}static createProperty(e,t=b){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const o="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,o,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){return{get(){return this[t]},set(i){const a=this[e];this[t]=i,this.requestUpdate(e,a,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||b}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const o of t)this.createProperty(o,e[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const o=new Set(e.flat(1/0).reverse());for(const e of o)t.unshift(v(e))}else void 0!==e&&t.push(v(e));return t}static _$Ep(e,t){const o=t.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,o;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(o=e.hostConnected)||void 0===o||o.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{l?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const o=document.createElement("style"),i=n.litNonce;void 0!==i&&o.setAttribute("nonce",i),o.textContent=t.cssText,e.appendChild(o)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EO(e,t,o=b){var i;const a=this.constructor._$Ep(e,o);if(void 0!==a&&!0===o.reflect){const r=(void 0!==(null===(i=o.converter)||void 0===i?void 0:i.toAttribute)?o.converter:f).toAttribute(t,o.type);this._$El=e,null==r?this.removeAttribute(a):this.setAttribute(a,r),this._$El=null}}_$AK(e,t){var o;const i=this.constructor,a=i._$Ev.get(e);if(void 0!==a&&this._$El!==a){const e=i.getPropertyOptions(a),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(o=e.converter)||void 0===o?void 0:o.fromAttribute)?e.converter:f;this._$El=a,this[a]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,o){let i=!0;void 0!==e&&(((o=o||this.constructor.getPropertyOptions(e)).hasChanged||g)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===o.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,o))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const o=this._$AL;try{t=this.shouldUpdate(o),t?(this.willUpdate(o),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(o)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(o)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}var x;w.finalized=!0,w.elementProperties=new Map,w.elementStyles=[],w.shadowRootOptions={mode:"open"},null==m||m({ReactiveElement:w}),(null!==(_=h.reactiveElementVersions)&&void 0!==_?_:h.reactiveElementVersions=[]).push("1.6.1");const $=window,k=$.trustedTypes,E=k?k.createPolicy("lit-html",{createHTML:e=>e}):void 0,C="$lit$",S=`lit$${(Math.random()+"").slice(9)}$`,A="?"+S,M=`<${A}>`,z=document,D=()=>z.createComment(""),P=e=>null===e||"object"!=typeof e&&"function"!=typeof e,T=Array.isArray,j="[ \t\n\f\r]",O=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,N=/-->/g,B=/>/g,R=RegExp(`>|${j}(?:([^\\s"'>=/]+)(${j}*=${j}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),F=/'/g,G=/"/g,I=/^(?:script|style|textarea|title)$/i,U=e=>(t,...o)=>({_$litType$:e,strings:t,values:o}),H=U(1),L=U(2),W=Symbol.for("lit-noChange"),V=Symbol.for("lit-nothing"),Z=new WeakMap,K=z.createTreeWalker(z,129,null,!1);class Y{constructor({strings:e,_$litType$:t},o){let i;this.parts=[];let a=0,r=0;const n=e.length-1,l=this.parts,[s,d]=((e,t)=>{const o=e.length-1,i=[];let a,r=2===t?"<svg>":"",n=O;for(let t=0;t<o;t++){const o=e[t];let l,s,d=-1,c=0;for(;c<o.length&&(n.lastIndex=c,s=n.exec(o),null!==s);)c=n.lastIndex,n===O?"!--"===s[1]?n=N:void 0!==s[1]?n=B:void 0!==s[2]?(I.test(s[2])&&(a=RegExp("</"+s[2],"g")),n=R):void 0!==s[3]&&(n=R):n===R?">"===s[0]?(n=null!=a?a:O,d=-1):void 0===s[1]?d=-2:(d=n.lastIndex-s[2].length,l=s[1],n=void 0===s[3]?R:'"'===s[3]?G:F):n===G||n===F?n=R:n===N||n===B?n=O:(n=R,a=void 0);const u=n===R&&e[t+1].startsWith("/>")?" ":"";r+=n===O?o+M:d>=0?(i.push(l),o.slice(0,d)+C+o.slice(d)+S+u):o+S+(-2===d?(i.push(void 0),t):u)}const l=r+(e[o]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==E?E.createHTML(l):l,i]})(e,t);if(this.el=Y.createElement(s,o),K.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(i=K.nextNode())&&l.length<n;){if(1===i.nodeType){if(i.hasAttributes()){const e=[];for(const t of i.getAttributeNames())if(t.endsWith(C)||t.startsWith(S)){const o=d[r++];if(e.push(t),void 0!==o){const e=i.getAttribute(o.toLowerCase()+C).split(S),t=/([.?@])?(.*)/.exec(o);l.push({type:1,index:a,name:t[2],strings:e,ctor:"."===t[1]?ee:"?"===t[1]?oe:"@"===t[1]?ie:X})}else l.push({type:6,index:a})}for(const t of e)i.removeAttribute(t)}if(I.test(i.tagName)){const e=i.textContent.split(S),t=e.length-1;if(t>0){i.textContent=k?k.emptyScript:"";for(let o=0;o<t;o++)i.append(e[o],D()),K.nextNode(),l.push({type:2,index:++a});i.append(e[t],D())}}}else if(8===i.nodeType)if(i.data===A)l.push({type:2,index:a});else{let e=-1;for(;-1!==(e=i.data.indexOf(S,e+1));)l.push({type:7,index:a}),e+=S.length-1}a++}}static createElement(e,t){const o=z.createElement("template");return o.innerHTML=e,o}}function q(e,t,o=e,i){var a,r,n,l;if(t===W)return t;let s=void 0!==i?null===(a=o._$Co)||void 0===a?void 0:a[i]:o._$Cl;const d=P(t)?void 0:t._$litDirective$;return(null==s?void 0:s.constructor)!==d&&(null===(r=null==s?void 0:s._$AO)||void 0===r||r.call(s,!1),void 0===d?s=void 0:(s=new d(e),s._$AT(e,o,i)),void 0!==i?(null!==(n=(l=o)._$Co)&&void 0!==n?n:l._$Co=[])[i]=s:o._$Cl=s),void 0!==s&&(t=q(e,s._$AS(e,t.values),s,i)),t}class J{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var t;const{el:{content:o},parts:i}=this._$AD,a=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:z).importNode(o,!0);K.currentNode=a;let r=K.nextNode(),n=0,l=0,s=i[0];for(;void 0!==s;){if(n===s.index){let t;2===s.type?t=new Q(r,r.nextSibling,this,e):1===s.type?t=new s.ctor(r,s.name,s.strings,this,e):6===s.type&&(t=new ae(r,this,e)),this._$AV.push(t),s=i[++l]}n!==(null==s?void 0:s.index)&&(r=K.nextNode(),n++)}return a}v(e){let t=0;for(const o of this._$AV)void 0!==o&&(void 0!==o.strings?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}}class Q{constructor(e,t,o,i){var a;this.type=2,this._$AH=V,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=i,this._$Cp=null===(a=null==i?void 0:i.isConnected)||void 0===a||a}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=q(this,e,t),P(e)?e===V||null==e||""===e?(this._$AH!==V&&this._$AR(),this._$AH=V):e!==this._$AH&&e!==W&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):(e=>T(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==V&&P(this._$AH)?this._$AA.nextSibling.data=e:this.$(z.createTextNode(e)),this._$AH=e}g(e){var t;const{values:o,_$litType$:i}=e,a="number"==typeof i?this._$AC(e):(void 0===i.el&&(i.el=Y.createElement(i.h,this.options)),i);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===a)this._$AH.v(o);else{const e=new J(a,this),t=e.u(this.options);e.v(o),this.$(t),this._$AH=e}}_$AC(e){let t=Z.get(e.strings);return void 0===t&&Z.set(e.strings,t=new Y(e)),t}T(e){T(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let o,i=0;for(const a of e)i===t.length?t.push(o=new Q(this.k(D()),this.k(D()),this,this.options)):o=t[i],o._$AI(a),i++;i<t.length&&(this._$AR(o&&o._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var o;for(null===(o=this._$AP)||void 0===o||o.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cp=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class X{constructor(e,t,o,i,a){this.type=1,this._$AH=V,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=a,o.length>2||""!==o[0]||""!==o[1]?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=V}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,o,i){const a=this.strings;let r=!1;if(void 0===a)e=q(this,e,t,0),r=!P(e)||e!==this._$AH&&e!==W,r&&(this._$AH=e);else{const i=e;let n,l;for(e=a[0],n=0;n<a.length-1;n++)l=q(this,i[o+n],t,n),l===W&&(l=this._$AH[n]),r||(r=!P(l)||l!==this._$AH[n]),l===V?e=V:e!==V&&(e+=(null!=l?l:"")+a[n+1]),this._$AH[n]=l}r&&!i&&this.j(e)}j(e){e===V?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class ee extends X{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===V?void 0:e}}const te=k?k.emptyScript:"";class oe extends X{constructor(){super(...arguments),this.type=4}j(e){e&&e!==V?this.element.setAttribute(this.name,te):this.element.removeAttribute(this.name)}}class ie extends X{constructor(e,t,o,i,a){super(e,t,o,i,a),this.type=5}_$AI(e,t=this){var o;if((e=null!==(o=q(this,e,t,0))&&void 0!==o?o:V)===W)return;const i=this._$AH,a=e===V&&i!==V||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==V&&(i===V||a);a&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,o;"function"==typeof this._$AH?this._$AH.call(null!==(o=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==o?o:this.element,e):this._$AH.handleEvent(e)}}class ae{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){q(this,e)}}const re=$.litHtmlPolyfillSupport;var ne,le;null==re||re(Y,Q),(null!==(x=$.litHtmlVersions)&&void 0!==x?x:$.litHtmlVersions=[]).push("2.7.2");class se extends w{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const o=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=o.firstChild),o}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,o)=>{var i,a;const r=null!==(i=null==o?void 0:o.renderBefore)&&void 0!==i?i:t;let n=r._$litPart$;if(void 0===n){const e=null!==(a=null==o?void 0:o.renderBefore)&&void 0!==a?a:null;r._$litPart$=n=new Q(t.insertBefore(D(),e),e,void 0,null!=o?o:{})}return n._$AI(e),n})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return W}}se.finalized=!0,se._$litElement$=!0,null===(ne=globalThis.litElementHydrateSupport)||void 0===ne||ne.call(globalThis,{LitElement:se});const de=globalThis.litElementPolyfillSupport;null==de||de({LitElement:se}),(null!==(le=globalThis.litElementVersions)&&void 0!==le?le:globalThis.litElementVersions=[]).push("3.3.1");const ce=e=>t=>"function"==typeof t?((e,t)=>(customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:o,elements:i}=t;return{kind:o,elements:i,finisher(t){customElements.define(e,t)}}})(e,t),ue=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(o){o.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(o){o.createProperty(t.key,e)}};function ve(e){return(t,o)=>void 0!==o?((e,t,o)=>{t.constructor.createProperty(o,e)})(e,t,o):ue(e,t)}function _e(e){return ve({...e,state:!0})}function he(e,t){return(({finisher:e,descriptor:t})=>(o,i)=>{var a;if(void 0===i){const i=null!==(a=o.originalKey)&&void 0!==a?a:o.key,r=null!=t?{kind:"method",placement:"prototype",key:i,descriptor:t(o.key)}:{...o,key:i};return null!=e&&(r.finisher=function(t){e(t,i)}),r}{const a=o.constructor;void 0!==t&&Object.defineProperty(o,i,t(i)),null==e||e(a,i)}})({descriptor:o=>{const i={get(){var t,o;return null!==(o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(e))&&void 0!==o?o:null},enumerable:!0,configurable:!0};if(t){const t="symbol"==typeof o?Symbol():"__"+o;i.get=function(){var o,i;return void 0===this[t]&&(this[t]=null!==(i=null===(o=this.renderRoot)||void 0===o?void 0:o.querySelector(e))&&void 0!==i?i:null),this[t]}}return i}})}var pe;null===(pe=window.HTMLSlotElement)||void 0===pe||pe.prototype.assignedElements;class ye{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,o){this._$Ct=e,this._$AM=t,this._$Ci=o}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}const me=(e=>(...t)=>({_$litDirective$:e,values:t}))(class extends ye{constructor(e){var t;if(super(e),1!==e.type||"class"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){var o,i;if(void 0===this.it){this.it=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in t)t[e]&&!(null===(o=this.nt)||void 0===o?void 0:o.has(e))&&this.it.add(e);return this.render(t)}const a=e.element.classList;this.it.forEach((e=>{e in t||(a.remove(e),this.it.delete(e))}));for(const e in t){const o=!!t[e];o===this.it.has(e)||(null===(i=this.nt)||void 0===i?void 0:i.has(e))||(o?(a.add(e),this.it.add(e)):(a.remove(e),this.it.delete(e)))}return W}}),fe=(e,t)=>Number(`${Math.round(Number(`${e}e${t}`))}e-${t}`);function ge(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}function be(e,t=0){return ge(e)?Number(e):t}var we="0.1.5";console.groupCollapsed(`%c⚡ Power Flow Card Plus v${we} is installed`,"color: #488fc2; font-weight: bold"),console.log("Readme:","https://github.com/flixlix/power-flow-card-plus"),console.groupEnd();const xe=function(e,t,o){var i;return void 0===o&&(o=!1),function(){var t=[].slice.call(arguments),a=this,r=o&&!i;clearTimeout(i),i=setTimeout((function(){i=null,o||e.apply(a,t)}),6e4),r&&e.apply(a,t)}}((e=>{console.log(`%c⚡ Power Flow Card Plus v${we} %cError: ${e}`,"color: #488fc2; font-weight: bold","color: #b33a3a; font-weight: normal")})),$e=u`:host{--mdc-icon-size:24px;--clickable-cursor:pointer;--individualone-color:#d0cc5b;--individualtwo-color:#964cb5;--non-fossil-color:var(--energy-non-fossil-color, #0f9d58);--icon-non-fossil-color:var(--non-fossil-color, #0f9d58);--icon-solar-color:var(--energy-solar-color, #ff9800);--icon-individualone-color:var(--individualone-color, #d0cc5b);--icon-individualtwo-color:var(--individualtwo-color, #964cb5);--icon-grid-color:var(--energy-grid-consumption-color, #488fc2);--icon-battery-color:var(--energy-battery-in-color, #f06292);--icon-home-color:var(--energy-grid-consumption-color, #488fc2);--text-solar-color:var(--primary-text-color);--text-non-fossil-color:var(--primary-text-color);--text-individualone-color:var(--primary-text-color);--text-individualtwo-color:var(--primary-text-color);--text-home-color:var(--primary-text-color);--secondary-text-individualone-color:var(--primary-text-color);--secondary-text-individualtwo-color:var(--primary-text-color);--text-battery-state-of-charge-color:var(--primary-text-color);--cirlce-grid-color:var(--energy-grid-consumption-color, #488fc2);--circle-battery-color:var(--energy-battery-in-color, #f06292);--secondary-text-solar-color:var(--primary-text-color);--secondary-text-grid-color:var(--primary-text-color);--secondary-text-home-color:var(--primary-text-color);--secondary-text-non-fossil-color:var(--primary-text-color);--lines-svg-not-flat-line-height:106%;--lines-svg-not-flat-line-top:-3%;--lines-svg-flat-width:calc(100% - 160px);--lines-svg-not-flat-width:calc(103% - 165px)}.card-content{position:relative;margin:0 auto}.card-content,.row{max-width:470px}.lines{position:absolute;bottom:0;left:0;width:100%;height:146px;display:flex;justify-content:center;padding:0 16px 16px;box-sizing:border-box}.lines.individual1-individual2{bottom:110px}.lines.high{bottom:100px;height:156px}.lines svg{width:var(--lines-svg-flat-width);height:100%;max-width:340px}.lines svg:not(.flat-line){width:var(--lines-svg-not-flat-width);height:var(--lines-svg-not-flat-line-height);top:var(--lines-svg-not-flat-line-top);position:relative}.row{display:flex;justify-content:space-between;max-width:500px;margin:0 auto}.circle-container{display:flex;flex-direction:column;align-items:center;z-index:2}.circle-container.solar{margin:0 4px;height:130px}.circle-container.individual2{margin-left:4px;height:130px}.circle-container.individual1{margin-left:4px;height:130px}.circle-container.individual1.bottom{position:relative;top:-20px;margin-bottom:-20px}.circle-container.battery{height:110px;justify-content:flex-end}.spacer{width:84px}.circle{width:80px;height:80px;border-radius:50%;box-sizing:border-box;border:2px solid;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-size:12px;line-height:12px;position:relative;text-decoration:none;color:var(--primary-text-color)}.circle-container .circle{cursor:var(--clickable-cursor)}#battery-grid{stroke:var(--energy-grid-return-color)}ha-icon{padding-bottom:2px}ha-icon.small{--mdc-icon-size:12px}.label{color:var(--secondary-text-color);font-size:12px;max-width:80px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;min-height:20px}line,path{stroke:var(--disabled-text-color);stroke-width:1;fill:none}.circle svg{position:absolute;fill:none;stroke-width:4px;width:100%;height:100%;top:0;left:0}span.secondary-info{color:var(--primary-text-color);font-size:12px;max-width:60px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.individual2 circle,.individual2 path{stroke:var(--individualtwo-color)}#individual1-icon{color:var(--icon-individualone-color)}#individual2-icon{color:var(--icon-individualtwo-color)}#solar-icon{color:var(--icon-solar-color)}circle.individual2{stroke-width:4;fill:var(--individualtwo-color)}.individual2 .circle{border-color:var(--individualtwo-color)}.individual1 circle,.individual1 path{stroke:var(--individualone-color)}circle.individual1{stroke-width:4;fill:var(--individualone-color)}.individual1 .circle{border-color:var(--individualone-color)}.circle-container.low-carbon{margin-right:4px;height:130px}.low-carbon path{stroke:var(--non-fossil-color)}.low-carbon .circle{border-color:var(--non-fossil-color)}.low-carbon ha-icon:not(.small){color:var(--icon-non-fossil-color)}circle.low-carbon{stroke-width:4;fill:var(--non-fossil-color);stroke:var(--non-fossil-color)}.solar{color:var(--primary-text-color)}.solar .circle{border-color:var(--energy-solar-color)}.solar ha-icon:not(.small){color:var(--icon-solar-color)}circle.solar,path.solar{stroke:var(--energy-solar-color)}circle.solar{stroke-width:4;fill:var(--energy-solar-color)}.battery .circle{border-color:var(--circle-battery-color)}circle.battery,path.battery{stroke:var(--energy-battery-out-color)}circle.battery-home,path.battery-home{stroke:var(--energy-battery-out-color)}circle.battery-home{stroke-width:4;fill:var(--energy-battery-out-color)}circle.battery-solar,path.battery-solar{stroke:var(--energy-battery-in-color)}circle.battery-solar{stroke-width:4;fill:var(--energy-battery-in-color)}.battery-in{color:var(--energy-battery-in-color)}.battery-out{color:var(--energy-battery-out-color)}path.battery-from-grid{stroke:var(--energy-grid-consumption-color)}path.battery-to-grid{stroke:var(--energy-grid-return-color)}.battery ha-icon:not(.small){color:var(--icon-battery-color)}circle.battery-to-grid,circle.return,path.return{stroke:var(--energy-grid-return-color)}circle.battery-to-grid,circle.return{stroke-width:4;fill:var(--energy-grid-return-color)}.return{color:var(--energy-grid-return-color)}.grid .circle{border-color:var(--circle-grid-color)}.consumption{color:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid,path.grid{stroke:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid{stroke-width:4;fill:var(--energy-grid-consumption-color)}.grid ha-icon:not(.small){color:var(--icon-grid-color)}.home .circle{border-width:0;border-color:var(--primary-color)}.home .circle.border{border-width:2px}.home ha-icon:not(.small){color:var(--icon-home-color)}.circle svg circle{animation:rotate-in .6s ease-in;transition:stroke-dashoffset .4s,stroke-dasharray .4s;fill:none}span.solar{color:var(--text-solar-color)}span.low-carbon{color:var(--text-non-fossil-color)}span.nonFossilFuelSecondary.secondary-info{color:var(--secondary-text-non-fossil-color)}#home-circle{color:var(--text-home-color)}.individual1 .circle{color:var(--text-individualone-color)}.individual2 .circle{color:var(--text-individualtwo-color)}.individual1 span.secondary-info{color:var(--secondary-text-individualone-color)}.individual2 span.secondary-info{color:var(--secondary-text-individualtwo-color)}.solar span.secondary-info{color:var(--secondary-text-solar-color)}.grid span.secondary-info{color:var(--secondary-text-grid-color)}.home span.secondary-info{color:var(--secondary-text-home-color)}#battery-state-of-charge-text{color:var(--text-battery-state-of-charge-color)}@keyframes rotate-in{from{stroke-dashoffset:238.76104;stroke-dasharray:238.76104}}.card-actions a{text-decoration:none}.home-circle-sections{pointer-events:none}`;var ke={label:{car:"Car",motorbike:"Motorbike"}},Ee={combined:"Combined Entity (One entity with positive and negative values)",separated:"Separated Entities (One entity for consumption and one for production)",custom_colors:"Custom Colors",secondary_info:"Secondary Info",power_outage:"Power Outage",grid:"Grid",solar:"Solar",battery:"Battery",fossil_fuel_percentage:"Fossil Fuel",home:"Home",individual:"Individual",advanced:"Advanced Options",decimals:"Decimals",consumption:"Consumption",production:"Production",color_icon:"Color of Icon",color_circle:"Color of Circle",color_value:"Color of Value",color_state_of_charge_value:"Color",display_zero:"Display Zero",display_zero_tolerance:"Display Zero Tolerance",display_state:"Display State",display_zero_state:"Display Zero State",invert_state:"Invert State",template:"Template",unit_of_measurement:"Unit",unit_white_space:"Unit White Space",label_alert:"Label for Alert",icon_alert:"Icon for Alert",state_alert:"State of Alert",state_of_charge:"State of Charge",state_of_charge_unit_white_space:"White Space",state_of_charge_unit:"Unit",state_of_charge_decimals:"Decimals",state_of_charge_icon:"Icon",state_type:"Type of State",subtract_individual:"Subtract Individual",override_state:"Override State",calculate_flow_rate:"Calculate Flow Rate",inverted_animation:"Invert Animation",show_direction:"Show Direction",color:"Color",dashboard_link:"Dashboard Link",dashboard_link_label:"Dashboard Link Name",w_decimals:"Watt Decimals",kw_decimals:"Kilowatt Decimals",max_flow_rate:"Max Flow Rate",min_flow_rate:"Min Flow Rate",max_expected_power:"Max Expected Power",min_expected_power:"Min Expected Power",watt_threshold:"Watt to Kilowatt Threshold",display_zero_lines:"Display Zero Lines",clickable_entities:"Clickable Entities",use_new_flow_rate_model:"New Flow Rate Model",use_metadata:"Use Metadata"},Ce={card:ke,editor:Ee},Se={label:{car:"Auto",motorbike:"Motorrad"}},Ae={combined:"Kombinierte Entität (Eine Entität mit positiven und negativen Werten)",separated:"Getrennte Entitäten (Eine Entität für den Verbrauch und eine für die Produktion)",custom_colors:"Benutzerdefinierte Farben",secondary_info:"Sekundäre Information",power_outage:"Stromausfall",grid:"Netz",solar:"Solar",battery:"Batterie",fossil_fuel_percentage:"Fossile Brennstoffe",home:"Zuhause",individual:"Individuell",advanced:"Erweiterte Optionen",decimals:"Dezimalstellen",consumption:"Verbrauch",production:"Produktion",color_icon:"Farbe des Symbols",color_circle:"Farbe des Kreises",color_value:"Farbe des Wertes",color_state_of_charge_value:"Farbe",display_zero:"Null anzeigen",display_zero_tolerance:"Nulltoleranz",display_state:"Zustand anzeigen",display_zero_state:"Nullzustand anzeigen",invert_state:"Zustand umkehren",template:"Vorlage",unit_of_measurement:"Einheit",unit_white_space:"Weißraum für Einheit",label_alert:"Beschriftung für Alarm",icon_alert:"Symbol für Alarm",state_alert:"Alarmzustand",state_of_charge:"Ladezustand",state_of_charge_unit_white_space:"Leerzeichen",state_of_charge_unit:"Einheit",state_of_charge_decimals:"Dezimalstellen",state_of_charge_icon:"Symbol",state_type:"Typ des Zustands",subtract_individual:"Individuell abziehen",override_state:"Zustand überschreiben",calculate_flow_rate:"Flussrate berechnen",inverted_animation:"Animation umkehren",show_direction:"Richtung anzeigen",color:"Farbe",dashboard_link:"Dashboard-Link",dashboard_link_label:"Name des Dashboard-Links",w_decimals:"Watt-Dezimalstellen",kw_decimals:"Kilowatt-Dezimalstellen",max_flow_rate:"Maximale Flussrate",min_flow_rate:"Minimale Flussrate",max_expected_power:"Maximale erwartete Leistung",min_expected_power:"Minimale erwartete Leistung",watt_threshold:"Watt-zu-Kilowatt-Schwelle",display_zero_lines:"Nulllinien anzeigen",clickable_entities:"Klickbare Entitäten",use_new_flow_rate_model:"Neues Fluss-Modell verwenden",use_metadata:"Metadaten verwenden"},Me={card:Se,editor:Ae},ze={label:{car:"Carro",motorbike:"Mota"}},De={combined:"Entidade combinada (uma entidade com valores positivos e negativos)",separated:"Entidades Separadas (Uma entidade para consumo e outra para produção)",custom_colors:"Cores personalizadas",secondary_info:"Informação Secundária",power_outage:"Falta de energia",grid:"Rede",solar:"Solar",battery:"Bateria",fossil_fuel_percentage:"Combustíveis Fósseis",home:"Casa",individual:"Individual",advanced:"Opções Avançadas",decimals:"Casas Decimais",consumption:"Consumo",production:"Produção",color_icon:"Cor do Ícone",color_circle:"Cor do Círculo",color_value:"Cor do Valor",color_state_of_charge_value:"Cor",display_zero:"Mostrar Zero",display_zero_tolerance:"Tolerância do Zero",display_state:"Mostrar Estado",display_zero_state:"Mostrar Estado Zero",invert_state:"Inverter Estado",template:"Modelo",unit_of_measurement:"Unidade",unit_white_space:"Espaçamento da Unidade",label_alert:"Nome para Alerta",icon_alert:"Ícone para Alerta",state_alert:"Estado do Alerta",state_of_charge:"Estado de Carga",state_of_charge_unit_white_space:"Espaçamento",state_of_charge_unit:"Unidade",state_of_charge_decimals:"Casas Decimais",state_of_charge_icon:"Ícone",state_type:"Tipo de Estado",subtract_individual:"Subtrair Individualmente",override_state:"Substituir Estado",calculate_flow_rate:"Calcular Taxa de Fluxo",inverted_animation:"Animação Invertida",show_direction:"Mostrar Direção",color:"Cor",dashboard_link:"Link do Painel de Controlo",dashboard_link_label:"Nome do Link do Painel de Controlo",w_decimals:"Casas Decimais de Watt",kw_decimals:"Casas Decimais de Quilowatt",max_flow_rate:"Taxa de Fluxo Máxima",min_flow_rate:"Taxa de Fluxo Mínima",max_expected_power:"Potência Máxima Esperada",min_expected_power:"Potência Mínima Esperada",watt_threshold:"Limiar de Watt para Quilowatt",display_zero_lines:"Mostrar Linhas Zero",clickable_entities:"Entidades Clicáveis",use_new_flow_rate_model:"Utilizar Novo Modelo de Velocidade",use_metadata:"Utilizar Metadados"},Pe={card:ze,editor:De},Te={label:{car:"Carro",motorbike:"Mota"}},je={combined:"Entidade combinada (uma entidade com valores positivos e negativos)",separated:"Entidades Separadas (Uma entidade para consumo e outra para produção)",custom_colors:"Cores personalizadas",secondary_info:"Informação Secundária",power_outage:"Falta de energia",grid:"Rede",solar:"Solar",battery:"Bateria",fossil_fuel_percentage:"Combustíveis Fósseis",home:"Casa",individual:"Individual",advanced:"Opções Avançadas",decimals:"Casas Decimais",consumption:"Consumo",production:"Produção",color_icon:"Cor do Ícone",color_circle:"Cor do Círculo",color_value:"Cor do Valor",color_state_of_charge_value:"Cor",display_zero:"Exibir Zero",display_zero_tolerance:"Tolerância de Zero",display_state:"Exibir Estado",display_zero_state:"Exibir Estado Zero",invert_state:"Inverter Estado",template:"Modelo",unit_of_measurement:"Unidade",unit_white_space:"Espaçamento da Unidade",label_alert:"Rótulo para Alerta",icon_alert:"Ícone para Alerta",state_alert:"Estado do Alerta",state_of_charge:"Estado de Carga",state_of_charge_unit_white_space:"Espaçamento",state_of_charge_unit:"Unidade",state_of_charge_decimals:"Casas Decimais",state_of_charge_icon:"Ícone",state_type:"Tipo de Estado",subtract_individual:"Subtrair Individualmente",override_state:"Substituir Estado",calculate_flow_rate:"Calcular Taxa de Fluxo",inverted_animation:"Animação Invertida",show_direction:"Mostrar Direção",color:"Cor",dashboard_link:"Link do Painel",dashboard_link_label:"Nome do Link do Painel",w_decimals:"Casas Decimais de Watts",kw_decimals:"Casas Decimais de Quilowatts",max_flow_rate:"Taxa de Fluxo Máxima",min_flow_rate:"Taxa de Fluxo Mínima",max_expected_power:"Potência Máxima Esperada",min_expected_power:"Potência Mínima Esperada",watt_threshold:"Limiar de Watts para Quilowatts",display_zero_lines:"Exibir Linhas Zero",clickable_entities:"Entidades Clicáveis",use_new_flow_rate_model:"Utilizar Novo Modelo de Velocidade",use_metadata:"Utilizar Metadados"},Oe={card:Te,editor:je},Ne={label:{car:"Coche",motorbike:"Motocicleta"}},Be={combined:"Entidad combinada (una entidad con valores positivos y negativos)",separated:"Entidades separadas (una entidad de consumo y otra de producción)",custom_colors:"Colores personalizados",secondary_info:"Información secundaria",power_outage:"Corte de energía",grid:"Red eléctrica",solar:"Solar",battery:"Batería",fossil_fuel_percentage:"Combustible Fósil",home:"Inicio",individual:"Individual",advanced:"Opciones Avanzadas",decimals:"Decimales",consumption:"Consumo",production:"Producción",color_icon:"Color del Icono",color_circle:"Color del Círculo",color_value:"Color del Valor",color_state_of_charge_value:"Color",display_zero:"Mostrar Cero",display_zero_tolerance:"Tolerancia de Cero",display_state:"Mostrar Estado",display_zero_state:"Mostrar Estado Cero",invert_state:"Invertir Estado",template:"Plantilla",unit_of_measurement:"Unidad",unit_white_space:"Espacio en Blanco de la Unidad",label_alert:"Etiqueta para Alerta",icon_alert:"Ícono para Alerta",state_alert:"Estado de Alerta",state_of_charge:"Estado de Carga",state_of_charge_unit_white_space:"Espacio en Blanco",state_of_charge_unit:"Unidad",state_of_charge_decimals:"Decimales",state_of_charge_icon:"Ícono",state_type:"Tipo de Estado",subtract_individual:"Restar Individualmente",override_state:"Sobrescribir Estado",calculate_flow_rate:"Calcular Tasa de Flujo",inverted_animation:"Animación Invertida",show_direction:"Mostrar Dirección",color:"Color",dashboard_link:"Enlace del Tablero",dashboard_link_label:"Nombre del Enlace del Tablero",w_decimals:"Decimales de Vatio",kw_decimals:"Decimales de Kilovatio",max_flow_rate:"Tasa de Flujo Máxima",min_flow_rate:"Tasa de Flujo Mínima",max_expected_power:"Potencia Máxima Esperada",min_expected_power:"Potencia Mínima Esperada",watt_threshold:"Umbral de Vatio a Kilovatio",display_zero_lines:"Mostrar Líneas de Cero",clickable_entities:"Entidades Clicables",use_new_flow_rate_model:"Utilizar Nuevo Modelo de Tasa de Flujo",use_metadata:"Utilizar Metadatos"},Re={card:Ne,editor:Be},Fe={label:{car:"Auto",motorbike:"Motorfiets"}},Ge={combined:"Gecombineerde entiteit (één entiteit met positieve en negatieve waarden)",separated:"Gescheiden entiteiten (één entiteit voor consumptie en één voor productie)",custom_colors:"Aangepaste kleuren",secondary_info:"Secundaire informatie",power_outage:"Stroomuitval",grid:"Elektriciteitsnet",solar:"Zonne-energie",battery:"Batterij",fossil_fuel_percentage:"Fossiele Brandstof",home:"Thuis",individual:"Individueel",advanced:"Geavanceerde Opties",decimals:"Decimalen",consumption:"Verbruik",production:"Productie",color_icon:"Kleur van Pictogram",color_circle:"Kleur van Cirkel",color_value:"Kleur van Waarde",color_state_of_charge_value:"Kleur",display_zero:"Nul Weergeven",display_zero_tolerance:"Nultolerantie Weergeven",display_state:"Toestand Weergeven",display_zero_state:"Nul Toestand Weergeven",invert_state:"Toestand Omkeren",template:"Sjabloon",unit_of_measurement:"Eenheid",unit_white_space:"Eenheid Spaties",label_alert:"Label voor Alarm",icon_alert:"Pictogram voor Alarm",state_alert:"Toestand van Alarm",state_of_charge:"Laadstatus",state_of_charge_unit_white_space:"Spaties",state_of_charge_unit:"Eenheid",state_of_charge_decimals:"Decimalen",state_of_charge_icon:"Pictogram",state_type:"Type Toestand",subtract_individual:"Individueel Aftrekken",override_state:"Toestand Overschrijven",calculate_flow_rate:"Stroomsnelheid Berekenen",inverted_animation:"Animatie Omkeren",show_direction:"Richting Weergeven",color:"Kleur",dashboard_link:"Dashboard Link",dashboard_link_label:"Naam van Dashboard Link",w_decimals:"Watt Decimalen",kw_decimals:"Kilowatt Decimalen",max_flow_rate:"Maximale Stroomsnelheid",min_flow_rate:"Minimale Stroomsnelheid",max_expected_power:"Maximaal Verwacht Vermogen",min_expected_power:"Minimaal Verwacht Vermogen",watt_threshold:"Watt naar Kilowatt Drempelwaarde",display_zero_lines:"Nullijnen Weergeven",clickable_entities:"Klikbare Entiteiten",use_new_flow_rate_model:"Nieuw Stroomsnelheid Model Gebruiken",use_metadata:"Metadata Gebruiken"},Ie={card:Fe,editor:Ge},Ue={label:{car:"Auto",motorbike:"Motocicletta"}},He={combined:"Entità combinata (un'entità con valori positivi e negativi)",separated:"Entità separate (Un'entità per il consumo e una per la produzione)",custom_colors:"Colori personalizzati",secondary_info:"Informazioni secondarie",power_outage:"Interruzione di corrente",grid:"Rete Elettrica",solar:"Solare",battery:"Batteria",fossil_fuel_percentage:"Carburante Fossile",home:"Casa",individual:"Individuale",advanced:"Opzioni Avanzate",decimals:"Decimali",consumption:"Consumo",production:"Produzione",color_icon:"Colore dell'Icona",color_circle:"Colore del Cerchio",color_value:"Colore del Valore",color_state_of_charge_value:"Colore",display_zero:"Mostra Zero",display_zero_tolerance:"Tolleranza dello Zero",display_state:"Mostra Stato",display_zero_state:"Mostra Stato Zero",invert_state:"Inverti Stato",template:"Modello",unit_of_measurement:"Unità",unit_white_space:"Spazio Bianco Unità",label_alert:"Etichetta per l'Allarme",icon_alert:"Icona per l'Allarme",state_alert:"Stato dell'Allarme",state_of_charge:"Stato di Carica",state_of_charge_unit_white_space:"Spazio Bianco",state_of_charge_unit:"Unità",state_of_charge_decimals:"Decimali",state_of_charge_icon:"Icona",state_type:"Tipo di Stato",subtract_individual:"Sottrai Individualmente",override_state:"Sovrascrivi Stato",calculate_flow_rate:"Calcola Tasso di Flusso",inverted_animation:"Animazione Invertita",show_direction:"Mostra Direzione",color:"Colore",dashboard_link:"Collegamento Dashboard",dashboard_link_label:"Nome Collegamento Dashboard",w_decimals:"Decimali Watt",kw_decimals:"Decimali Kilowatt",max_flow_rate:"Tasso di Flusso Massimo",min_flow_rate:"Tasso di Flusso Minimo",max_expected_power:"Potenza Massima Prevista",min_expected_power:"Potenza Minima Prevista",watt_threshold:"Soglia Watt per Kilowatt",display_zero_lines:"Mostra Linee Zero",clickable_entities:"Entità Cliccabili",use_new_flow_rate_model:"Utilizza Nuovo Modello di Tasso di Flusso",use_metadata:"Utilizza Metadati"},Le={card:Ue,editor:He},We={label:{car:"Voiture",motorbike:"Moto"}},Ve={combined:"Entité combinée (une entité avec des valeurs positives et négatives)",separated:"Entités séparées (une entité pour la consommation et une pour la production)",custom_colors:"Couleurs personnalisées",secondary_info:"Informations secondaires",power_outage:"Panne de courant",grid:"Réseau Électrique",solar:"Solaire",battery:"Batterie",fossil_fuel_percentage:"Carburant fossile",home:"Domicile",individual:"Individuel",advanced:"Options avancées",decimals:"Décimales",consumption:"Consommation",production:"Production",color_icon:"Couleur de l'icône",color_circle:"Couleur du cercle",color_value:"Couleur de la valeur",color_state_of_charge_value:"Couleur",display_zero:"Afficher zéro",display_zero_tolerance:"Tolérance de l'affichage zéro",display_state:"Afficher l'état",display_zero_state:"Afficher l'état zéro",invert_state:"Inverser l'état",template:"Modèle",unit_of_measurement:"Unité",unit_white_space:"Espace blanc de l'unité",label_alert:"Libellé de l'alerte",icon_alert:"Icône de l'alerte",state_alert:"État de l'alerte",state_of_charge:"État de charge",state_of_charge_unit_white_space:"Espace blanc de l'unité",state_of_charge_unit:"Unité",state_of_charge_decimals:"Décimales",state_of_charge_icon:"Icône",state_type:"Type d'état",subtract_individual:"Soustraire l'individuel",override_state:"Remplacer l'état",calculate_flow_rate:"Calculer le débit",inverted_animation:"Animation inversée",show_direction:"Afficher la direction",color:"Couleur",dashboard_link:"Lien du tableau de bord",dashboard_link_label:"Nom du lien du tableau de bord",w_decimals:"Décimales de watt",kw_decimals:"Décimales de kilowatt",max_flow_rate:"Débit maximal",min_flow_rate:"Débit minimal",max_expected_power:"Puissance maximale attendue",min_expected_power:"Puissance minimale attendue",watt_threshold:"Seuil de watt vers kilowatt",display_zero_lines:"Afficher les lignes zéro",clickable_entities:"Entités cliquables",use_new_flow_rate_model:"Nouveau modèle de débit",use_metadata:"Utiliser les métadonnées"},Ze={card:We,editor:Ve},Ke={label:{car:"Автомобиль",motorbike:"Мотоцикл"}},Ye={combined:"Комбинированный объект (один объект с положительными и отрицательными значениями)",separated:"Отдельные объекты (один объект для потребления и один для производства)",custom_colors:"Пользовательские цвета",secondary_info:"Вторичная информация",power_outage:"Отключение электричества",grid:"Электрическая сеть",solar:"Солнечная",battery:"Батарея",fossil_fuel_percentage:"Полный объем ископаемого топлива",home:"Домашняя",individual:"Индивидуальная",advanced:"Расширенные настройки",decimals:"Десятичные",consumption:"Потребление",production:"Производство",color_icon:"Цвет иконки",color_circle:"Цвет круга",color_value:"Цвет значения",color_state_of_charge_value:"Цвет",display_zero:"Отображать ноль",display_zero_tolerance:"Допустимая погрешность нуля",display_state:"Отображать состояние",display_zero_state:"Отображать состояние нуля",invert_state:"Инвертировать состояние",template:"Шаблон",unit_of_measurement:"Единица измерения",unit_white_space:"Пробел единицы измерения",label_alert:"Метка для предупреждения",icon_alert:"Иконка для предупреждения",state_alert:"Состояние предупреждения",state_of_charge:"Уровень заряда",state_of_charge_unit_white_space:"Пробел",state_of_charge_unit:"Единица измерения",state_of_charge_decimals:"Десятичные",state_of_charge_icon:"Иконка",state_type:"Тип состояния",subtract_individual:"Вычесть индивидуально",override_state:"Переопределить состояние",calculate_flow_rate:"Рассчитать скорость потока",inverted_animation:"Инвертированная анимация",show_direction:"Показать направление",color:"Цвет",dashboard_link:"Ссылка на панель управления",dashboard_link_label:"Название ссылки на панель управления",w_decimals:"Десятичные ватт",kw_decimals:"Десятичные киловатт",max_flow_rate:"Максимальная скорость потока",min_flow_rate:"Минимальная скорость потока",max_expected_power:"Максимальная ожидаемая мощность",min_expected_power:"Минимальная ожидаемая мощность",watt_threshold:"Пороговое значение ватт в киловатты",display_zero_lines:"Отображать нулевые линии",clickable_entities:"Кликабельные сущности",use_new_flow_rate_model:"Использовать новую модель скорости потока",use_metadata:"Использовать метаданные"},qe={card:Ke,editor:Ye},Je={label:{car:"Auto",motorbike:"Moottoripyörä"}},Qe={combined:"Yhdistetty kokonaisuus (yksi kokonaisuus positiivisilla ja negatiivisilla arvoilla)",separated:"Erotetut kokonaisuudet (yksi kulutukseen ja yksi tuotantoon)",custom_colors:"Mukautetut värit",secondary_info:"Toissijaiset tiedot",power_outage:"Sähkökatkos",grid:"Sähköverkko",solar:"Aurinko",battery:"Akku",fossil_fuel_percentage:"Fossiilinen polttoaine",home:"Koti",individual:"Yksittäinen",advanced:"Lisäasetukset",decimals:"Desimaalit",consumption:"Kulutus",production:"Tuotanto",color_icon:"Ikonin väri",color_circle:"Ympyrän väri",color_value:"Arvon väri",color_state_of_charge_value:"Väri",display_zero:"Näytä nolla",display_zero_tolerance:"Näytä nolla-toleranssi",display_state:"Näytä tila",display_zero_state:"Näytä nolla-tila",invert_state:"Käänteinen tila",template:"Malli",unit_of_measurement:"Yksikkö",unit_white_space:"Yksikön välilyönti",label_alert:"Hälytyksen teksti",icon_alert:"Hälytyksen kuvake",state_alert:"Hälytyksen tila",state_of_charge:"Varauksen tila",state_of_charge_unit_white_space:"Välilyönti",state_of_charge_unit:"Yksikkö",state_of_charge_decimals:"Desimaalit",state_of_charge_icon:"Kuvake",state_type:"Tilan tyyppi",subtract_individual:"Vähennä yksittäinen",override_state:"Korvaa tila",calculate_flow_rate:"Laske virtausnopeus",inverted_animation:"Käänteinen animaatio",show_direction:"Näytä suunta",color:"Väri",dashboard_link:"Ohjauspaneelin linkki",dashboard_link_label:"Ohjauspaneelin linkin nimi",w_decimals:"Wattien desimaalit",kw_decimals:"Kilowattien desimaalit",max_flow_rate:"Maksimivirtausnopeus",min_flow_rate:"Minimivirtausnopeus",max_expected_power:"Ennustettu maksimiteho",min_expected_power:"Ennustettu minimiteho",watt_threshold:"Wattin ja kilowatin kynnysarvo",display_zero_lines:"Näytä nolla-viivat",clickable_entities:"Napautettavat kohteet",use_new_flow_rate_model:"Uusi virtausnopeusmalli",use_metadata:"Käytä metatietoja"},Xe={card:Je,editor:Qe},et={label:{car:"Samochód",motorbike:"Motocykl"}},tt={combined:"Jednostka połączona (jedna jednostka z wartościami dodatnimi i ujemnymi)",separated:"Oddzielne podmioty (jeden podmiot do konsumpcji i jeden do produkcji)",custom_colors:"Kolory niestandardowe",secondary_info:"Informacje dodatkowe",power_outage:"Brak prądu",grid:"Sieć elektryczna",solar:"Energia słoneczna",battery:"Bateria",fossil_fuel_percentage:"Paliwo kopalne",home:"Dom",individual:"Indywidualne",advanced:"Zaawansowane opcje",decimals:"Miejsca po przecinku",consumption:"Zużycie",production:"Produkcja",color_icon:"Kolor ikony",color_circle:"Kolor okręgu",color_value:"Kolor wartości",color_state_of_charge_value:"Kolor",display_zero:"Wyświetl zero",display_zero_tolerance:"Wyświetl tolerancję zera",display_state:"Wyświetl stan",display_zero_state:"Wyświetl stan zera",invert_state:"Odwróć stan",template:"Szablon",unit_of_measurement:"Jednostka",unit_white_space:"Spacja jednostki",label_alert:"Etykieta alertu",icon_alert:"Ikona alertu",state_alert:"Stan alertu",state_of_charge:"Stan naładowania",state_of_charge_unit_white_space:"Spacja jednostki",state_of_charge_unit:"Jednostka",state_of_charge_decimals:"Miejsca po przecinku",state_of_charge_icon:"Ikona",state_type:"Typ stanu",subtract_individual:"Odjęcie indywidualne",override_state:"Nadpisanie stanu",calculate_flow_rate:"Oblicz wskaźnik przepływu",inverted_animation:"Odwróć animację",show_direction:"Pokaż kierunek",color:"Kolor",dashboard_link:"Link do panelu",dashboard_link_label:"Nazwa linku do panelu",w_decimals:"Miejsca po przecinku dla watów",kw_decimals:"Miejsca po przecinku dla kilowatów",max_flow_rate:"Maksymalna szybkość przepływu",min_flow_rate:"Minimalna szybkość przepływu",max_expected_power:"Maksymalna oczekiwana moc",min_expected_power:"Minimalna oczekiwana moc",watt_threshold:"Próg watów na kilowaty",display_zero_lines:"Wyświetl linie zera",clickable_entities:"Klikalne jednostki",use_new_flow_rate_model:"Nowy model wskaźnika przepływu",use_metadata:"Użyj metadanych"},ot={card:et,editor:tt};const it={en:Object.freeze({__proto__:null,card:ke,editor:Ee,default:Ce}),de:Object.freeze({__proto__:null,card:Se,editor:Ae,default:Me}),pt:Object.freeze({__proto__:null,card:ze,editor:De,default:Pe}),pt_BR:Object.freeze({__proto__:null,card:Te,editor:je,default:Oe}),es:Object.freeze({__proto__:null,card:Ne,editor:Be,default:Re}),nl:Object.freeze({__proto__:null,card:Fe,editor:Ge,default:Ie}),it:Object.freeze({__proto__:null,card:Ue,editor:He,default:Le}),fr:Object.freeze({__proto__:null,card:We,editor:Ve,default:Ze}),ru:Object.freeze({__proto__:null,card:Ke,editor:Ye,default:qe}),fi:Object.freeze({__proto__:null,card:Je,editor:Qe,default:Xe}),pl:Object.freeze({__proto__:null,card:et,editor:tt,default:ot})},at="en";function rt(e,t){try{return e.split(".").reduce(((e,t)=>e[t]),it[t])}catch(e){return}}function nt(e){let t=rt(e,(localStorage.getItem("selectedLanguage")||"en").replace(/['"]+/g,"").replace("-","_"));return t||(t=rt(e,at)),null!=t?t:e}const lt=238.76104;!function(e){const t=window;t.customCards=t.customCards||[],t.customCards.push(Object.assign(Object.assign({},{type:"power-flow-card-plus",name:"Power Flow Card Plus",description:"An extended version of the power flow card with richer options, advanced features and a few small UI enhancements. Inspired by the Energy Dashboard."}),{preview:!0,documentationURL:"https://github.com/flixlix/power-flow-card-plus"}))}();let st=class extends se{constructor(){super(...arguments),this._config={},this._templateResults={},this._unsubRenderTemplates=new Map,this._width=0,this.unavailableOrMisconfiguredError=e=>xe(`Entity "${null!=e?e:"Unknown"}" is not available or misconfigured`),this.entityExists=e=>e in this.hass.states,this.entityAvailable=e=>{var t;return ge(null===(t=this.hass.states[e])||void 0===t?void 0:t.state)},this.entityInverted=e=>{var t;return!!(null===(t=this._config.entities[e])||void 0===t?void 0:t.invert_state)},this.previousDur={},this.circleRate=(e,t)=>{var o,i;if(this._config.use_new_flow_rate_model){const t=this._config.max_expected_power,o=this._config.min_expected_power,i=this._config.max_flow_rate,a=this._config.min_flow_rate;return this.mapRange(e,i,a,o,t)}const a=null===(o=this._config)||void 0===o?void 0:o.min_flow_rate,r=null===(i=this._config)||void 0===i?void 0:i.max_flow_rate;return r-e/(t>0?t:e)*(r-a)},this.getEntityStateObj=e=>{if(e&&this.entityAvailable(e))return this.hass.states[e];this.unavailableOrMisconfiguredError(e)},this.additionalCircleRate=(e,t)=>!0===e&&t?t:ge(e)?e:1.66,this.getEntityState=e=>e&&this.entityAvailable(e)?be(this.hass.states[e].state):(this.unavailableOrMisconfiguredError(e),0),this.getEntityStateWatts=e=>{var t;if(!e||!this.entityAvailable(e))return this.unavailableOrMisconfiguredError(e),0;const o=this.hass.states[e],i=be(o.state);return(null===(t=o.attributes.unit_of_measurement)||void 0===t?void 0:t.toUpperCase().startsWith("KW"))?1e3*i:i},this.displayNonFossilState=(e,t)=>{var o,i,a,r,n,l,s;if(!e||!this.entityAvailable(e))return this.unavailableOrMisconfiguredError(e),"NaN";const d=null===(i=null===(o=this._config.entities.fossil_fuel_percentage)||void 0===o?void 0:o.unit_white_space)||void 0===i||i,c="percentage"===(null===(a=this._config.entities.fossil_fuel_percentage)||void 0===a?void 0:a.state_type)?"%":"W",u=1-this.getEntityState(e)/100;let v,_;v="string"==typeof(null===(r=this._config.entities.grid)||void 0===r?void 0:r.entity)?t:this.getEntityStateWatts(null===(n=this._config.entities.grid)||void 0===n?void 0:n.entity.consumption)||0;const h=null!==(s=null===(l=this._config.entities.fossil_fuel_percentage)||void 0===l?void 0:l.display_zero_tolerance)&&void 0!==s?s:0;if("W"===c){let e=v*u;h&&e<h&&(e=0),_=this.displayValue(e,void 0,d)}else{let t=100-this.getEntityState(e);h&&t<h&&(t=0),_=this.displayValue(t,c,d,0)}return _},this.displayValue=(e,t,o,i)=>{if(null===e)return"0";if(Number.isNaN(+e))return e.toString();const r=Number(e),n=void 0===t&&r>=this._config.watt_threshold;return`${a(n?fe(r/1e3,this._config.kw_decimals):fe(r,null!=i?i:this._config.w_decimals),this.hass.locale)}${!1===o?"":" "}${t||(n?"kW":"W")}`}}setConfig(e){var t,o,i,a,r,n;if(!e.entities||!(null===(o=null===(t=e.entities)||void 0===t?void 0:t.battery)||void 0===o?void 0:o.entity)&&!(null===(a=null===(i=e.entities)||void 0===i?void 0:i.grid)||void 0===a?void 0:a.entity)&&!(null===(n=null===(r=e.entities)||void 0===r?void 0:r.solar)||void 0===n?void 0:n.entity))throw new Error("At least one entity for battery, grid or solar must be defined");this._config=Object.assign(Object.assign({},e),{kw_decimals:be(e.kw_decimals,1),min_flow_rate:be(e.min_flow_rate,.75),max_flow_rate:be(e.max_flow_rate,6),w_decimals:be(e.w_decimals,0),watt_threshold:be(e.watt_threshold,1e3),max_expected_power:be(e.max_expected_power,2e3),min_expected_power:be(e.min_expected_power,.01)})}connectedCallback(){super.connectedCallback(),this._tryConnectAll()}disconnectedCallback(){this._tryDisconnectAll()}static async getConfigElement(){return await Promise.resolve().then((function(){return Yt})),document.createElement("power-flow-card-plus-editor")}static getStubConfig(e){return function(e){function t(t,o){const i=e.states[t].attributes.friendly_name;return o.some((e=>t.includes(e)||(null==i?void 0:i.includes(e))))}const o=Object.keys(e.states).filter((t=>{const o=e.states[t];return o.state&&o.attributes&&"power"===o.attributes.device_class||o.entity_id.includes("power")})),i=["grid","utility","net","meter"],a=["solar","pv","photovoltaic","inverter"],r=["battery"],n=["battery_percent","battery_level","state_of_charge","soc","percentage"],l=o.filter((e=>t(e,i)))[0],s=o.filter((e=>t(e,a)))[0],d=o.filter((e=>t(e,r)))[0],c=Object.keys(e.states).filter((t=>{const o=e.states[t];return o&&o.state&&o.attributes&&"%"===o.attributes.unit_of_measurement})).filter((e=>t(e,n)))[0];return{entities:{battery:{entity:null!=d?d:"",state_of_charge:null!=c?c:""},grid:l?{entity:l}:void 0,solar:s?{entity:s,display_zero_state:!0}:void 0},clickable_entities:!0,display_zero_lines:!0,use_new_flow_rate_model:!0,w_decimals:0,kw_decimals:1,min_flow_rate:.75,max_flow_rate:6,max_expected_power:2e3,min_expected_power:.01,watt_threshold:1e3}}(e)}getCardSize(){return 3}mapRange(e,t,o,i,a){return e>a?o:(e-i)*(o-t)/(a-i)+t}openDetails(e,t){if(e.stopPropagation(),!t||!this._config.clickable_entities)return;if(!this.entityExists(t))return;const o=new CustomEvent("hass-more-info",{composed:!0,detail:{entityId:t}});this.dispatchEvent(o)}hasField(e,t){var o,i;return!!(void 0!==e&&!0===(null==e?void 0:e.display_zero)||Math.abs(this.getEntityStateWatts(null==e?void 0:e.entity))>(null!==(o=null==e?void 0:e.display_zero_tolerance)&&void 0!==o?o:0)&&this.entityAvailable(null==e?void 0:e.entity)||t)&&"string"==typeof(null===(i=this.hass.states[null==e?void 0:e.entity])||void 0===i?void 0:i.state)}showLine(e){var t;return!1!==(null===(t=this._config)||void 0===t?void 0:t.display_zero_lines)||e>0}computeFieldIcon(e,t){var o,i;return(null==e?void 0:e.icon)?e.icon:(null==e?void 0:e.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(e.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.icon)||"":t}computeFieldName(e,t){var o,i;return(null==e?void 0:e.name)?e.name:(null==e?void 0:e.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(e.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.friendly_name)||"":t}convertColorListToHex(e){return"#".concat(e.map((e=>e.toString(16).padStart(2,"0"))).join(""))}render(){var e,t,o,i,a,r,n,l,s,d,c,u,v,_,h,p,y,m,f,g,b,w,x,$,k,E,C,S,A,M,z,D,P,T,j,O,N,B,R,F,G,I,U,W,V,Z,K,Y,q,J,Q,X,ee,te,oe,ie,ae,re,ne,le,se,de,ce,ue,ve,_e,he,pe,ye,fe,we,xe,$e,ke,Ee,Ce,Se,Ae,Me,ze,De,Pe,Te,je,Oe,Ne,Be,Re,Fe,Ge,Ie,Ue,He,Le,We,Ve,Ze,Ke,Ye,qe,Je,Qe,Xe,et,tt,ot,it,at,rt,st,dt,ct,ut,vt,_t,ht,pt,yt,mt,ft,gt,bt,wt,xt,$t,kt,Et,Ct,St,At,Mt,zt,Dt,Pt,Tt,jt,Ot,Nt,Bt,Rt,Ft,Gt,It,Ut,Ht,Lt,Wt,Vt,Zt,Kt,Yt,qt,Jt,Qt,Xt,eo,to,oo,io,ao,ro,no,lo,so,co,uo,vo,_o,ho,po,yo,mo,fo,go,bo,wo,xo,$o,ko,Eo,Co,So,Ao,Mo,zo,Do,Po,To,jo,Oo,No,Bo,Ro,Fo,Go,Io,Uo,Ho,Lo,Wo,Vo,Zo,Ko,Yo,qo,Jo,Qo,Xo,ei,ti,oi,ii,ai,ri,ni,li,si,di,ci,ui,vi,_i,hi,pi,yi,mi,fi,gi,bi,wi,xi,$i,ki,Ei,Ci,Si,Ai,Mi,zi,Di,Pi,Ti,ji,Oi,Ni;if(!this._config||!this.hass)return H``;const{entities:Bi}=this._config;this.style.setProperty("--clickable-cursor",this._config.clickable_entities?"pointer":"default");const Ri=null,Fi=null,Gi={entity:null===(e=Bi.grid)||void 0===e?void 0:e.entity,has:void 0!==(null===(t=null==Bi?void 0:Bi.grid)||void 0===t?void 0:t.entity),hasReturnToGrid:"string"==typeof(null===(o=Bi.grid)||void 0===o?void 0:o.entity)||(null===(a=null===(i=Bi.grid)||void 0===i?void 0:i.entity)||void 0===a?void 0:a.production),state:{fromGrid:0,toGrid:Ri,toBattery:Ri,toHome:Ri},powerOutage:{has:this.hasField(null===(r=Bi.grid)||void 0===r?void 0:r.power_outage,!0),isOutage:(Bi.grid&&(null===(l=this.hass.states[null===(n=Bi.grid.power_outage)||void 0===n?void 0:n.entity])||void 0===l?void 0:l.state))===(null!==(c=null===(d=null===(s=Bi.grid)||void 0===s?void 0:s.power_outage)||void 0===d?void 0:d.state_alert)&&void 0!==c?c:"on")},icon:this.computeFieldIcon(Bi.grid,"mdi:transmission-tower"),name:this.computeFieldName(Bi.grid,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.grid")),mainEntity:"object"==typeof(null===(u=Bi.grid)||void 0===u?void 0:u.entity)?Bi.grid.entity.consumption||Bi.grid.entity.production:null===(v=Bi.grid)||void 0===v?void 0:v.entity,color:{fromGrid:null===(h=null===(_=Bi.grid)||void 0===_?void 0:_.color)||void 0===h?void 0:h.consumption,toGrid:null===(y=null===(p=Bi.grid)||void 0===p?void 0:p.color)||void 0===y?void 0:y.production,icon_type:null===(m=Bi.grid)||void 0===m?void 0:m.color_icon,circle_type:null===(f=Bi.grid)||void 0===f?void 0:f.color_circle},secondary:{entity:null===(b=null===(g=Bi.grid)||void 0===g?void 0:g.secondary_info)||void 0===b?void 0:b.entity,has:this.hasField(null===(w=Bi.grid)||void 0===w?void 0:w.secondary_info),state:Fi,icon:null===($=null===(x=Bi.grid)||void 0===x?void 0:x.secondary_info)||void 0===$?void 0:$.icon,unit:null===(E=null===(k=Bi.grid)||void 0===k?void 0:k.secondary_info)||void 0===E?void 0:E.unit_of_measurement,unit_white_space:null===(S=null===(C=Bi.grid)||void 0===C?void 0:C.secondary_info)||void 0===S?void 0:S.unit_white_space,color:{type:null===(M=null===(A=Bi.grid)||void 0===A?void 0:A.secondary_info)||void 0===M?void 0:M.color_value}}},Ii={entity:null===(z=Bi.solar)||void 0===z?void 0:z.entity,has:void 0!==(null===(D=Bi.solar)||void 0===D?void 0:D.entity),state:{total:Ri,toHome:Ri,toGrid:Ri,toBattery:Ri},icon:this.computeFieldIcon(Bi.solar,"mdi:solar-power"),name:this.computeFieldName(Bi.solar,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.solar")),secondary:{entity:null===(T=null===(P=Bi.solar)||void 0===P?void 0:P.secondary_info)||void 0===T?void 0:T.entity,has:this.hasField(null===(j=Bi.solar)||void 0===j?void 0:j.secondary_info),state:Fi,icon:null===(N=null===(O=Bi.solar)||void 0===O?void 0:O.secondary_info)||void 0===N?void 0:N.icon,unit:null===(R=null===(B=Bi.solar)||void 0===B?void 0:B.secondary_info)||void 0===R?void 0:R.unit_of_measurement,unit_white_space:null===(G=null===(F=Bi.solar)||void 0===F?void 0:F.secondary_info)||void 0===G?void 0:G.unit_white_space}},Ui={entity:null===(I=Bi.battery)||void 0===I?void 0:I.entity,has:void 0!==(null===(U=null==Bi?void 0:Bi.battery)||void 0===U?void 0:U.entity),mainEntity:"object"==typeof(null===(W=Bi.battery)||void 0===W?void 0:W.entity)?Bi.battery.entity.consumption:null===(V=Bi.battery)||void 0===V?void 0:V.entity,name:this.computeFieldName(Bi.battery,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.battery")),icon:this.computeFieldIcon(Bi.battery,"mdi:battery-high"),state_of_charge:{state:(null===(K=null===(Z=Bi.battery)||void 0===Z?void 0:Z.state_of_charge)||void 0===K?void 0:K.length)?this.getEntityState(null===(Y=Bi.battery)||void 0===Y?void 0:Y.state_of_charge):null,unit:(null===(q=null==Bi?void 0:Bi.battery)||void 0===q?void 0:q.state_of_charge_unit)||"%",unit_white_space:(null===(J=null==Bi?void 0:Bi.battery)||void 0===J?void 0:J.state_of_charge_unit_white_space)||!0,decimals:(null===(Q=null==Bi?void 0:Bi.battery)||void 0===Q?void 0:Q.state_of_charge_decimals)||0},state:{toBattery:0,fromBattery:0,toGrid:0},color:{fromBattery:null===(ee=null===(X=Bi.battery)||void 0===X?void 0:X.color)||void 0===ee?void 0:ee.consumption,toBattery:null===(oe=null===(te=Bi.battery)||void 0===te?void 0:te.color)||void 0===oe?void 0:oe.production,icon_type:void 0,circle_type:null===(ie=Bi.battery)||void 0===ie?void 0:ie.color_circle}},Hi={entity:null===(ae=Bi.home)||void 0===ae?void 0:ae.entity,has:void 0!==(null===(re=null==Bi?void 0:Bi.home)||void 0===re?void 0:re.entity),state:Ri,icon:this.computeFieldIcon(null==Bi?void 0:Bi.home,"mdi:home"),name:this.computeFieldName(null==Bi?void 0:Bi.home,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.home")),color:{icon_type:null===(ne=Bi.home)||void 0===ne?void 0:ne.color_icon},secondary:{entity:null===(se=null===(le=Bi.home)||void 0===le?void 0:le.secondary_info)||void 0===se?void 0:se.entity,has:this.hasField(null===(de=Bi.home)||void 0===de?void 0:de.secondary_info),state:null,unit:null===(ue=null===(ce=Bi.home)||void 0===ce?void 0:ce.secondary_info)||void 0===ue?void 0:ue.unit_of_measurement,unit_white_space:null===(_e=null===(ve=Bi.home)||void 0===ve?void 0:ve.secondary_info)||void 0===_e?void 0:_e.unit_white_space,icon:null===(pe=null===(he=Bi.home)||void 0===he?void 0:he.secondary_info)||void 0===pe?void 0:pe.icon,decimals:null===(fe=null===(ye=Bi.home)||void 0===ye?void 0:ye.secondary_info)||void 0===fe?void 0:fe.decimals}},Li=e=>{var t,o,i,a,r,n,l,s,d,c,u,v,_,h,p,y,m,f,g,b,w,x;return{entity:null===(t=Bi[e])||void 0===t?void 0:t.entity,has:this.hasField(Bi[e]),displayZero:null===(o=Bi[e])||void 0===o?void 0:o.display_zero,displayZeroTolerance:null===(i=Bi[e])||void 0===i?void 0:i.display_zero_tolerance,state:Ri,icon:this.computeFieldIcon(Bi[e],"individual1"===e?"mdi:car-electric":"mdi:motorbike-electric"),name:this.computeFieldName(Bi[e],nt("individual1"===e?"card.label.car":"card.label.motorbike")),color:null===(a=Bi[e])||void 0===a?void 0:a.color,unit:null===(r=Bi[e])||void 0===r?void 0:r.unit_of_measurement,unit_white_space:null===(n=Bi[e])||void 0===n?void 0:n.unit_white_space,decimals:null===(l=Bi[e])||void 0===l?void 0:l.decimals,invertAnimation:(null===(s=Bi[e])||void 0===s?void 0:s.inverted_animation)||!1,showDirection:(null===(d=Bi[e])||void 0===d?void 0:d.show_direction)||!1,secondary:{entity:null===(u=null===(c=Bi[e])||void 0===c?void 0:c.secondary_info)||void 0===u?void 0:u.entity,has:this.hasField(null===(v=Bi[e])||void 0===v?void 0:v.secondary_info,!0),state:Fi,icon:null===(h=null===(_=Bi[e])||void 0===_?void 0:_.secondary_info)||void 0===h?void 0:h.icon,unit:null===(y=null===(p=Bi[e])||void 0===p?void 0:p.secondary_info)||void 0===y?void 0:y.unit_of_measurement,unit_white_space:null===(f=null===(m=Bi[e])||void 0===m?void 0:m.secondary_info)||void 0===f?void 0:f.unit_white_space,displayZero:null===(b=null===(g=Bi[e])||void 0===g?void 0:g.secondary_info)||void 0===b?void 0:b.display_zero,displayZeroTolerance:null===(x=null===(w=Bi[e])||void 0===w?void 0:w.secondary_info)||void 0===x?void 0:x.display_zero_tolerance}}},Wi=Li("individual1"),Vi=Li("individual2"),Zi={entity:null===(we=Bi.fossil_fuel_percentage)||void 0===we?void 0:we.entity,name:(null===(xe=Bi.fossil_fuel_percentage)||void 0===xe?void 0:xe.name)||(null===($e=Bi.fossil_fuel_percentage)||void 0===$e?void 0:$e.use_metadata)&&(null===(ke=this.getEntityStateObj(Bi.fossil_fuel_percentage.entity))||void 0===ke?void 0:ke.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.low_carbon"),icon:(null===(Ee=Bi.fossil_fuel_percentage)||void 0===Ee?void 0:Ee.icon)||(null===(Ce=Bi.fossil_fuel_percentage)||void 0===Ce?void 0:Ce.use_metadata)&&(null===(Ae=null===(Se=this.getEntityStateObj(Bi.fossil_fuel_percentage.entity))||void 0===Se?void 0:Se.attributes)||void 0===Ae?void 0:Ae.icon)||"mdi:leaf",has:!1,hasPercentage:!1,state:{power:Ri},color:null===(Me=Bi.fossil_fuel_percentage)||void 0===Me?void 0:Me.color,color_value:null===(ze=Bi.fossil_fuel_percentage)||void 0===ze?void 0:ze.color_value,secondary:{entity:null===(Pe=null===(De=Bi.fossil_fuel_percentage)||void 0===De?void 0:De.secondary_info)||void 0===Pe?void 0:Pe.entity,has:this.hasField(null===(Te=Bi.fossil_fuel_percentage)||void 0===Te?void 0:Te.secondary_info,!0),state:Fi,icon:null===(Oe=null===(je=Bi.fossil_fuel_percentage)||void 0===je?void 0:je.secondary_info)||void 0===Oe?void 0:Oe.icon,unit:null===(Be=null===(Ne=Bi.fossil_fuel_percentage)||void 0===Ne?void 0:Ne.secondary_info)||void 0===Be?void 0:Be.unit_of_measurement,unit_white_space:null===(Fe=null===(Re=Bi.fossil_fuel_percentage)||void 0===Re?void 0:Re.secondary_info)||void 0===Fe?void 0:Fe.unit_white_space,color_value:null===(Ie=null===(Ge=Bi.fossil_fuel_percentage)||void 0===Ge?void 0:Ge.secondary_info)||void 0===Ie?void 0:Ie.color_value}};if(Gi.has&&("string"==typeof Bi.grid.entity?this.entityInverted("grid")?Gi.state.fromGrid=Math.abs(Math.min(this.getEntityStateWatts(null===(Ue=Bi.grid)||void 0===Ue?void 0:Ue.entity),0)):Gi.state.fromGrid=Math.max(this.getEntityStateWatts(null===(He=Bi.grid)||void 0===He?void 0:He.entity),0):Gi.state.fromGrid=this.getEntityStateWatts(Bi.grid.entity.consumption)),void 0!==(null===(Le=Bi.grid)||void 0===Le?void 0:Le.display_zero_tolerance)&&(Gi.state.fromGrid=Gi.state.fromGrid>(null===(We=Bi.grid)||void 0===We?void 0:We.display_zero_tolerance)?Gi.state.fromGrid:0),Gi.hasReturnToGrid&&("string"==typeof Bi.grid.entity?Gi.state.toGrid=this.entityInverted("grid")?Math.max(this.getEntityStateWatts(Bi.grid.entity),0):Math.abs(Math.min(this.getEntityStateWatts(Bi.grid.entity),0)):Gi.state.toGrid=this.getEntityStateWatts(null===(Ve=Bi.grid)||void 0===Ve?void 0:Ve.entity.production)),this.style.setProperty("--secondary-text-solar-color",(null===(Ke=null===(Ze=Bi.solar)||void 0===Ze?void 0:Ze.secondary_info)||void 0===Ke?void 0:Ke.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),Ii.secondary.has){const e=Number(this.hass.states[null===(qe=null===(Ye=Bi.solar)||void 0===Ye?void 0:Ye.secondary_info)||void 0===qe?void 0:qe.entity].state);Ii.secondary.state=Math.max(e,0)}if(void 0!==(null===(Je=Bi.solar)||void 0===Je?void 0:Je.color)){let e=null===(Qe=Bi.solar)||void 0===Qe?void 0:Qe.color;"object"==typeof e&&(e=this.convertColorListToHex(e)),this.style.setProperty("--energy-solar-color",e||"#ff9800")}if(this.style.setProperty("--icon-solar-color",(null===(Xe=Bi.solar)||void 0===Xe?void 0:Xe.color_icon)?"var(--energy-solar-color)":"var(--primary-text-color)"),Ii.has&&(this.entityInverted("solar")?Ii.state.total=Math.abs(Math.min(this.getEntityStateWatts(null===(et=Bi.solar)||void 0===et?void 0:et.entity),0)):Ii.state.total=Math.max(this.getEntityStateWatts(null===(tt=Bi.solar)||void 0===tt?void 0:tt.entity),0),(null===(ot=Bi.solar)||void 0===ot?void 0:ot.display_zero_tolerance)&&Bi.solar.display_zero_tolerance>=Ii.state.total&&(Ii.state.total=0)),Ui.has&&("string"==typeof(null===(it=Bi.battery)||void 0===it?void 0:it.entity)?(Ui.state.toBattery=this.entityInverted("battery")?Math.max(this.getEntityStateWatts(Bi.battery.entity),0):Math.abs(Math.min(this.getEntityStateWatts(Bi.battery.entity),0)),Ui.state.fromBattery=this.entityInverted("battery")?Math.abs(Math.min(this.getEntityStateWatts(Bi.battery.entity),0)):Math.max(this.getEntityStateWatts(Bi.battery.entity),0)):(Ui.state.toBattery=this.getEntityStateWatts(null===(rt=null===(at=Bi.battery)||void 0===at?void 0:at.entity)||void 0===rt?void 0:rt.production),Ui.state.fromBattery=this.getEntityStateWatts(null===(dt=null===(st=Bi.battery)||void 0===st?void 0:st.entity)||void 0===dt?void 0:dt.consumption)),(null===(ct=null==Bi?void 0:Bi.battery)||void 0===ct?void 0:ct.display_zero_tolerance)&&(Bi.battery.display_zero_tolerance>=Ui.state.toBattery&&(Ui.state.toBattery=0),Bi.battery.display_zero_tolerance>=Ui.state.fromBattery&&(Ui.state.fromBattery=0)),Ui.state.fromBattery=(null!==(ut=Ui.state.fromBattery)&&void 0!==ut?ut:0)-(null!==(vt=Ui.state.toGrid)&&void 0!==vt?vt:0)),Ii.has&&(Ii.state.toHome=(null!==(_t=Ii.state.total)&&void 0!==_t?_t:0)-(null!==(ht=Gi.state.toGrid)&&void 0!==ht?ht:0)-(null!==(pt=Ui.state.toBattery)&&void 0!==pt?pt:0)),null!==Ii.state.toHome&&Ii.state.toHome<0&&(Ui.has&&(Gi.state.toBattery=Math.abs(Ii.state.toHome),Gi.state.toBattery>(null!==(yt=Gi.state.fromGrid)&&void 0!==yt?yt:0)&&(Ui.state.toGrid=Math.min(Gi.state.toBattery-(null!==(mt=Gi.state.fromGrid)&&void 0!==mt?mt:0),0),Gi.state.toBattery=Gi.state.fromGrid)),Ii.state.toHome=0),Gi.state.toHome=Math.max(Gi.state.fromGrid-(null!==(ft=Gi.state.toBattery)&&void 0!==ft?ft:0),0),Ii.has&&Ui.has?(Ui.state.toGrid||(Ui.state.toGrid=Math.max(0,(Gi.state.toGrid||0)-(Ii.state.total||0)-(Ui.state.toBattery||0)-(Gi.state.toBattery||0))),Ii.state.toBattery=Ui.state.toBattery-(Gi.state.toBattery||0)):!Ii.has&&Ui.has&&(Ui.state.toGrid=Gi.state.toGrid||0),Ii.has&&Gi.state.toGrid&&(Ii.state.toGrid=Gi.state.toGrid-(null!==(gt=Ui.state.toGrid)&&void 0!==gt?gt:0)),this.style.setProperty("--text-solar-color",(null===(bt=Bi.solar)||void 0===bt?void 0:bt.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),void 0!==Gi.color.fromGrid&&"object"==typeof Gi.color.fromGrid&&(Gi.color.fromGrid=this.convertColorListToHex(Gi.color.fromGrid)),Gi.secondary.has){const e=Number(this.hass.states[null!==($t=null===(xt=null===(wt=Bi.grid)||void 0===wt?void 0:wt.secondary_info)||void 0===xt?void 0:xt.entity)&&void 0!==$t?$t:0].state);Gi.secondary.state=Math.max(e,0)}if(void 0!==Gi.color.toGrid&&("object"==typeof Gi.color.toGrid&&(Gi.color.toGrid=this.convertColorListToHex(Gi.color.toGrid)),this.style.setProperty("--energy-grid-return-color",Gi.color.toGrid||"#a280db")),void 0!==Gi.color.fromGrid&&("object"==typeof Gi.color.fromGrid&&(Gi.color.fromGrid=this.convertColorListToHex(Gi.color.fromGrid)),this.style.setProperty("--energy-grid-consumption-color",Gi.color.fromGrid||"#a280db")),void 0!==(null===(kt=Bi.grid)||void 0===kt?void 0:kt.display_zero_tolerance)&&(Gi.state.toGrid=Gi.state.toGrid>(null===(Et=Bi.grid)||void 0===Et?void 0:Et.display_zero_tolerance)?Gi.state.toGrid:0),this.style.setProperty("--icon-grid-color","consumption"===Gi.color.icon_type?"var(--energy-grid-consumption-color)":"production"===Gi.color.icon_type?"var(--energy-grid-return-color)":!0===Gi.color.icon_type?(null!==(Ct=Gi.state.fromGrid)&&void 0!==Ct?Ct:0)>=(null!==(St=Gi.state.toGrid)&&void 0!==St?St:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-grid-color","consumption"===Gi.secondary.color.type?"var(--energy-grid-consumption-color)":"production"===Gi.secondary.color.type?"var(--energy-grid-return-color)":!0===Gi.secondary.color.type?(null!==(At=Gi.state.fromGrid)&&void 0!==At?At:0)>=(null!==(Mt=Gi.state.toGrid)&&void 0!==Mt?Mt:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-grid-color","consumption"===Gi.color.circle_type?"var(--energy-grid-consumption-color)":"production"===Gi.color.circle_type?"var(--energy-grid-return-color)":!0===Gi.color.circle_type?(null!==(zt=Gi.state.fromGrid)&&void 0!==zt?zt:0)>=(null!==(Dt=Gi.state.toGrid)&&void 0!==Dt?Dt:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--energy-grid-consumption-color)"),void 0!==Wi.color&&("object"==typeof Wi.color&&(Wi.color=this.convertColorListToHex(Wi.color)),this.style.setProperty("--individualone-color",Wi.color)),this.style.setProperty("--icon-individualone-color",(null===(Pt=Bi.individual1)||void 0===Pt?void 0:Pt.color_icon)?"var(--individualone-color)":"var(--primary-text-color)"),Wi.has){const e=this.getEntityStateWatts(null===(Tt=Bi.individual1)||void 0===Tt?void 0:Tt.entity);e<0&&(Wi.invertAnimation=!Wi.invertAnimation),Wi.state=Math.abs(e)}if(Wi.secondary.has){const e=this.hass.states[null===(Ot=null===(jt=Bi.individual1)||void 0===jt?void 0:jt.secondary_info)||void 0===Ot?void 0:Ot.entity].state;"number"==typeof e?Wi.secondary.state=Math.max(e,0):"string"==typeof e&&(Wi.secondary.state=e)}if(void 0!==Zi.entity&&(Zi.hasPercentage=void 0!==(null===(Nt=Bi.fossil_fuel_percentage)||void 0===Nt?void 0:Nt.entity)&&!0===(null===(Bt=Bi.fossil_fuel_percentage)||void 0===Bt?void 0:Bt.display_zero)||1*(null!==(Rt=Gi.state.fromGrid)&&void 0!==Rt?Rt:0)-this.getEntityState(null===(Ft=Bi.fossil_fuel_percentage)||void 0===Ft?void 0:Ft.entity)/100>0&&void 0!==(null===(Gt=Bi.fossil_fuel_percentage)||void 0===Gt?void 0:Gt.entity)&&this.entityAvailable(null===(It=Bi.fossil_fuel_percentage)||void 0===It?void 0:It.entity)),void 0!==Vi.color&&("object"==typeof Vi.color&&(Vi.color=this.convertColorListToHex(Vi.color)),this.style.setProperty("--individualtwo-color",Vi.color)),this.style.setProperty("--icon-individualtwo-color",(null===(Ut=Bi.individual2)||void 0===Ut?void 0:Ut.color_icon)?"var(--individualtwo-color)":"var(--primary-text-color)"),Vi.has){const e=this.getEntityStateWatts(null===(Ht=Bi.individual2)||void 0===Ht?void 0:Ht.entity);e<0&&(Vi.invertAnimation=!Vi.invertAnimation),Vi.state=Math.abs(e)}if(Vi.secondary.has){const e=this.hass.states[null===(Wt=null===(Lt=Bi.individual2)||void 0===Lt?void 0:Lt.secondary_info)||void 0===Wt?void 0:Wt.entity].state;"number"==typeof e?Vi.secondary.state=Math.max(e,0):"string"==typeof e&&(Vi.secondary.state=e)}if(Hi.secondary.has){const e=Number(this.hass.states[null===(Zt=null===(Vt=Bi.home)||void 0===Vt?void 0:Vt.secondary_info)||void 0===Zt?void 0:Zt.entity].state);Hi.secondary.state=Math.max(e,0)}void 0!==Ui.color.fromBattery&&("object"==typeof Ui.color.fromBattery&&(Ui.color.fromBattery=this.convertColorListToHex(Ui.color.fromBattery)),this.style.setProperty("--energy-battery-out-color",Ui.color.fromBattery||"#4db6ac")),void 0!==Ui.color.toBattery&&("object"==typeof Ui.color.toBattery&&(Ui.color.toBattery=this.convertColorListToHex(Ui.color.toBattery)),this.style.setProperty("--energy-battery-in-color",Ui.color.toBattery||"#a280db")),Ui.color.icon_type=null===(Kt=Bi.battery)||void 0===Kt?void 0:Kt.color_icon,this.style.setProperty("--icon-battery-color","consumption"===Ui.color.icon_type?"var(--energy-battery-in-color)":"production"===Ui.color.icon_type?"var(--energy-battery-out-color)":!0===Ui.color.icon_type?Ui.state.fromBattery>=Ui.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)");const Ki=null===(Yt=Bi.battery)||void 0===Yt?void 0:Yt.color_state_of_charge_value;this.style.setProperty("--text-battery-state-of-charge-color","consumption"===Ki?"var(--energy-battery-in-color)":"production"===Ki?"var(--energy-battery-out-color)":!0===Ki?Ui.state.fromBattery>=Ui.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-battery-color","consumption"===Ui.color.circle_type?"var(--energy-battery-in-color)":"production"===Ui.color.circle_type||!0===Ui.color.circle_type&&Ui.state.fromBattery>=Ui.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)");const Yi=be(Wi.state,0)+be(Vi.state,0),qi=Math.max(Gi.state.toHome+(null!==(qt=Ii.state.toHome)&&void 0!==qt?qt:0)+(null!==(Jt=Ui.state.fromBattery)&&void 0!==Jt?Jt:0),0);let Ji=0;Ui.state.fromBattery&&(Ji=lt*(Ui.state.fromBattery/qi));let Qi=0;if(Ii.has&&(Qi=lt*(Ii.state.toHome/qi)),Zi.secondary.has){const e=this.hass.states[null===(Xt=null===(Qt=Bi.fossil_fuel_percentage)||void 0===Qt?void 0:Qt.secondary_info)||void 0===Xt?void 0:Xt.entity].state;"number"==typeof e?Zi.secondary.state=Math.max(e,0):"string"==typeof e&&(Zi.secondary.state=e)}let Xi=0;if(Zi.has=1*Gi.state.toHome-this.getEntityState(null===(eo=Bi.fossil_fuel_percentage)||void 0===eo?void 0:eo.entity)/100>0&&void 0!==(null===(to=Bi.fossil_fuel_percentage)||void 0===to?void 0:to.entity)&&this.entityAvailable(null===(oo=Bi.fossil_fuel_percentage)||void 0===oo?void 0:oo.entity),Zi.has){const e=1-this.getEntityState(null===(io=Bi.fossil_fuel_percentage)||void 0===io?void 0:io.entity)/100;Zi.state.power=Gi.state.toHome*e,Xi=lt*(Zi.state.power/qi)}Zi.hasPercentage=void 0!==(null===(ao=Bi.fossil_fuel_percentage)||void 0===ao?void 0:ao.entity)&&!0===(null===(ro=Bi.fossil_fuel_percentage)||void 0===ro?void 0:ro.display_zero)||Zi.has;const ea=Gi.state.toHome+(null!==(no=Ii.state.toHome)&&void 0!==no?no:0)+(null!==(lo=Ii.state.toGrid)&&void 0!==lo?lo:0)+(null!==(so=Ii.state.toBattery)&&void 0!==so?so:0)+(null!==(co=Ui.state.fromBattery)&&void 0!==co?co:0)+(null!==(uo=Gi.state.toBattery)&&void 0!==uo?uo:0)+(null!==(vo=Ui.state.toGrid)&&void 0!==vo?vo:0);null===Ui.state_of_charge.state?Ui.icon="mdi:battery":Ui.state_of_charge.state<=72&&Ui.state_of_charge.state>44?Ui.icon="mdi:battery-medium":Ui.state_of_charge.state<=44&&Ui.state_of_charge.state>16?Ui.icon="mdi:battery-low":Ui.state_of_charge.state<=16&&(Ui.icon="mdi:battery-outline"),void 0!==(null===(_o=Bi.battery)||void 0===_o?void 0:_o.icon)&&(Ui.icon=null===(ho=Bi.battery)||void 0===ho?void 0:ho.icon);const ta={batteryGrid:this.circleRate(null!==(yo=null!==(po=Gi.state.toBattery)&&void 0!==po?po:Ui.state.toGrid)&&void 0!==yo?yo:0,ea),batteryToHome:this.circleRate(null!==(mo=Ui.state.fromBattery)&&void 0!==mo?mo:0,ea),gridToHome:this.circleRate(Gi.state.toHome,ea),solarToBattery:this.circleRate(null!==(fo=Ii.state.toBattery)&&void 0!==fo?fo:0,ea),solarToGrid:this.circleRate(null!==(go=Ii.state.toGrid)&&void 0!==go?go:0,ea),solarToHome:this.circleRate(null!==(bo=Ii.state.toHome)&&void 0!==bo?bo:0,ea),individual1:this.circleRate(null!==(wo=Wi.state)&&void 0!==wo?wo:0,Yi),individual2:this.circleRate(null!==(xo=Vi.state)&&void 0!==xo?xo:0,Yi),nonFossil:this.circleRate(null!==($o=Zi.state.power)&&void 0!==$o?$o:0,ea)};["batteryGrid","batteryToHome","gridToHome","solarToBattery","solarToGrid","solarToHome"].forEach((e=>{const t=this[`${e}Flow`];t&&this.previousDur[e]&&this.previousDur[e]!==ta[e]&&(t.pauseAnimations(),t.setCurrentTime(t.getCurrentTime()*(ta[e]/this.previousDur[e])),t.unpauseAnimations()),this.previousDur[e]=ta[e]})),void 0!==Zi.color&&("object"==typeof Zi.color&&(Zi.color=this.convertColorListToHex(Zi.color)),this.style.setProperty("--non-fossil-color",Zi.color||"var(--energy-non-fossil-color)")),this.style.setProperty("--icon-non-fossil-color",(null===(ko=Bi.fossil_fuel_percentage)||void 0===ko?void 0:ko.color_icon)?"var(--non-fossil-color)":"var(--primary-text-color)");const oa=e=>void 0===e.state?"":this.displayValue(e.state,e.unit,e.unit_white_space,e.decimals),ia=oa(Wi),aa=oa(Vi);this.style.setProperty("--text-non-fossil-color",(null===(Eo=Bi.fossil_fuel_percentage)||void 0===Eo?void 0:Eo.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-non-fossil-color",(null===(So=null===(Co=Bi.fossil_fuel_percentage)||void 0===Co?void 0:Co.secondary_info)||void 0===So?void 0:So.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualone-color",(null===(Ao=Bi.individual1)||void 0===Ao?void 0:Ao.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualtwo-color",(null===(Mo=Bi.individual2)||void 0===Mo?void 0:Mo.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualone-color",(null===(Do=null===(zo=Bi.individual1)||void 0===zo?void 0:zo.secondary_info)||void 0===Do?void 0:Do.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualtwo-color",(null===(To=null===(Po=Bi.individual2)||void 0===Po?void 0:Po.secondary_info)||void 0===To?void 0:To.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-home-color",(null===(Oo=null===(jo=Bi.home)||void 0===jo?void 0:jo.secondary_info)||void 0===Oo?void 0:Oo.color_value)?"var(--text-home-color)":"var(--primary-text-color)");const ra={gridSecondary:null===(No=this._templateResults.gridSecondary)||void 0===No?void 0:No.result,solarSecondary:null===(Bo=this._templateResults.solarSecondary)||void 0===Bo?void 0:Bo.result,homeSecondary:null===(Ro=this._templateResults.homeSecondary)||void 0===Ro?void 0:Ro.result,individual1Secondary:null===(Fo=this._templateResults.individual1Secondary)||void 0===Fo?void 0:Fo.result,individual2Secondary:null===(Go=this._templateResults.individual2Secondary)||void 0===Go?void 0:Go.result,nonFossilFuelSecondary:null===(Io=this._templateResults.nonFossilFuelSecondary)||void 0===Io?void 0:Io.result},na=(null===(Uo=Bi.home)||void 0===Uo?void 0:Uo.override_state)&&Bi.home.entity?(null===(Ho=Bi.home)||void 0===Ho?void 0:Ho.subtract_individual)?this.displayValue(this.getEntityStateWatts(Bi.home.entity)-Yi):this.displayValue(this.getEntityStateWatts(Bi.home.entity)):(null===(Lo=Bi.home)||void 0===Lo?void 0:Lo.subtract_individual)?this.displayValue(qi-Yi||0):this.displayValue(qi),la=lt*((qi-(null!==(Wo=Zi.state.power)&&void 0!==Wo?Wo:0)-(null!==(Vo=Ui.state.fromBattery)&&void 0!==Vo?Vo:0)-(null!==(Zo=Ii.state.toHome)&&void 0!==Zo?Zo:0))/qi),sa={battery:{value:Ji,color:"var(--energy-battery-out-color)"},solar:{value:Qi,color:"var(--energy-solar-color)"},grid:{value:la,color:"var(--energy-grid-consumption-color)"},gridNonFossil:{value:Xi,color:"var(--energy-non-fossil-color)"}},da=this._width>420;Ii.has&&(Ui.has?(this.style.setProperty("--lines-svg-not-flat-line-height",da?"106%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",da?"-3%":"-1%"),this.style.setProperty("--lines-svg-flat-width","calc(100% - 160px)")):(this.style.setProperty("--lines-svg-not-flat-line-height",da?"104%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",da?"-2%":"-1%"),this.style.setProperty("--lines-svg-flat-width",da?"calc(100% - 154px)":"calc(100% - 157px)"),this.style.setProperty("--lines-svg-not-flat-width",da?"calc(103% - 172px)":"calc(103% - 169px)")));const ca=Object.keys(sa).reduce(((e,t)=>sa[e].value>sa[t].value?e:t));let ua="var(--primary-text-color)";"solar"===Hi.color.icon_type?ua="var(--energy-solar-color)":"battery"===Hi.color.icon_type?ua="var(--energy-battery-out-color)":"grid"===Hi.color.icon_type?ua="var(--energy-grid-consumption-color)":!0===Hi.color.icon_type&&(ua=sa[ca].color),this.style.setProperty("--icon-home-color",ua);const va=null===(Ko=Bi.home)||void 0===Ko?void 0:Ko.color_value;let _a="var(--primary-text-color)";"solar"===va?_a="var(--energy-solar-color)":"battery"===va?_a="var(--energy-battery-out-color)":"grid"===va?_a="var(--energy-grid-consumption-color)":!0===va&&(_a=sa[ca].color),this.style.setProperty("--text-home-color",_a);const ha=({className:e,template:t,value:o,entityId:i,icon:a})=>{var r,n;return o||t?H`<span class="secondary-info ${e}" @click="${e=>{this.openDetails(e,i)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,i)}}">${(null===(n=null===(r=Bi.solar)||void 0===r?void 0:r.secondary_info)||void 0===n?void 0:n.icon)?H`<ha-icon class="secondary-info small" .icon="${a}"></ha-icon>`:""} ${null!=t?t:o}</span>`:""},pa=(e,t)=>H`${e.secondary.has?H`${ha({className:t,entityId:e.secondary.entity,icon:e.secondary.icon,value:this.displayValue(e.secondary.state,e.secondary.unit,e.secondary.unit_white_space),template:ra.gridSecondary})}`:""}`,ya=(e,t)=>{var o,i;const a=ra[`${t}Secondary`],r=e.secondary.has?this.displayValue(e.secondary.state,e.secondary.unit,e.secondary.unit_white_space):void 0,n=!1!==e.secondary.displayZero||!ge(e.secondary.state)||(null!==(o=Number(e.secondary.state))&&void 0!==o?o:0)>(null!==(i=e.secondary.displayZeroTolerance)&&void 0!==i?i:0);return H`${e.secondary.has&&n||a?H`${ha({className:t,entityId:e.secondary.entity,icon:e.secondary.icon,value:r,template:ra[`${t}Secondary`]})}`:""}`};return H`<ha-card .header="${this._config.title}"><div class="card-content" id="power-flow-card-plus">${Ii.has||Vi.has||Wi.has||Zi.hasPercentage?H`<div class="row">${Zi.hasPercentage?H`<div class="circle-container low-carbon"><span class="label">${Zi.name}</span><div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Bi.fossil_fuel_percentage)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Bi.fossil_fuel_percentage)||void 0===t?void 0:t.entity)}}">${pa(Zi,"nonFossilFuelSecondary")}<ha-icon .icon="${Zi.icon}" class="low-carbon" style="${Zi.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Yo=Bi.fossil_fuel_percentage)||void 0===Yo?void 0:Yo.display_zero_state)||(Zi.state.power||0)>((null===(qo=Bi.fossil_fuel_percentage)||void 0===qo?void 0:qo.display_zero_tolerance)||0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Jo=Bi.fossil_fuel_percentage)||void 0===Jo?void 0:Jo.display_zero_state)||(Zi.state.power||0)>((null===(Qo=Bi.fossil_fuel_percentage)||void 0===Qo?void 0:Qo.display_zero_tolerance)||0)?H`<span class="low-carbon">${this.displayNonFossilState(Bi.fossil_fuel_percentage.entity,Gi.state.fromGrid)}</span>`:""}</div>${this.showLine(Zi.state.power||0)?H`<svg width="80" height="30"><path d="M40 -10 v40" class="low-carbon" id="low-carbon"/>${Zi.has?L`<circle r="2.4" class="low-carbon" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Xo=Bi.fossil_fuel_percentage)||void 0===Xo?void 0:Xo.calculate_flow_rate,ta.nonFossil)}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#low-carbon"></animateMotion></circle>`:""}</svg>`:""}</div>`:H`<div class="spacer"></div>`} ${Ii.has?H`<div class="circle-container solar"><span class="label">${Ii.name}</span><div class="circle" @click="${e=>{this.openDetails(e,Ii.entity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,Ii.entity)}}">${pa(Ii,"solar")}<ha-icon id="solar-icon" .icon="${Ii.icon}" style="${Ii.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(ei=Bi.solar)||void 0===ei?void 0:ei.display_zero_state)||(Ii.state.total||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(ti=Bi.solar)||void 0===ti?void 0:ti.display_zero_state)||(Ii.state.total||0)>0?H`<span class="solar">${this.displayValue(Ii.state.total)}</span>`:""}</div></div>`:Vi.has||Wi.has?H`<div class="spacer"></div>`:""} ${Vi.has?H`<div class="circle-container individual2"><span class="label">${Vi.name}</span><div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Bi.individual2)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Bi.individual2)||void 0===t?void 0:t.entity)}}">${ya(Vi,"individual2")}<ha-icon id="individual2-icon" .icon="${Vi.icon}" style="${Vi.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(oi=Bi.individual2)||void 0===oi?void 0:oi.display_zero_state)||(Vi.state||0)>(null!==(ii=Vi.displayZeroTolerance)&&void 0!==ii?ii:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(ai=Bi.individual2)||void 0===ai?void 0:ai.display_zero_state)||(Vi.state||0)>(null!==(ri=Vi.displayZeroTolerance)&&void 0!==ri?ri:0)?H`<span class="individual2">${Vi.showDirection?H`<ha-icon class="small" .icon="${Vi.invertAnimation?"mdi:arrow-down":"mdi:arrow-up"}"></ha-icon>`:""}${aa}</span>`:""}</div>${this.showLine(Vi.state||0)?H`<svg width="80" height="30"><path d="M40 -10 v50" id="individual2"/>${Vi.state?L`<circle r="2.4" class="individual2" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(ni=Bi.individual2)||void 0===ni?void 0:ni.calculate_flow_rate,ta.individual2)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${Vi.invertAnimation?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual2"></animateMotion></circle>`:""}</svg>`:""}</div>`:Wi.has?H`<div class="circle-container individual1"><span class="label">${Wi.name}</span><div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Bi.individual1)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Bi.individual1)||void 0===t?void 0:t.entity)}}">${ya(Wi,"individual1")}<ha-icon id="individual1-icon" .icon="${Wi.icon}" style="${Wi.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(li=Bi.individual1)||void 0===li?void 0:li.display_zero_state)||(Wi.state||0)>(null!==(si=Wi.displayZeroTolerance)&&void 0!==si?si:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(di=Bi.individual1)||void 0===di?void 0:di.display_zero_state)||(Wi.state||0)>(null!==(ci=Wi.displayZeroTolerance)&&void 0!==ci?ci:0)?H`<span class="individual1">${Wi.showDirection?H`<ha-icon class="small" .icon="${Wi.invertAnimation?"mdi:arrow-down":"mdi:arrow-up"}"></ha-icon>`:""}${ia}</span>`:""}</div>${this.showLine(Wi.state||0)?H`<svg width="80" height="30"><path d="M40 -10 v40" id="individual1"/>${Wi.state?L`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(ui=Bi.individual1)||void 0===ui?void 0:ui.calculate_flow_rate,ta.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${Wi.invertAnimation?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:H``}</div>`:H`<div class="spacer"></div>`}</div>`:H``}<div class="row">${Gi.has?H`<div class="circle-container grid"><div class="circle" @click="${e=>{const t="string"==typeof Bi.grid.entity?Bi.grid.entity:Bi.grid.entity.consumption||Bi.grid.entity.production;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Bi.grid.entity?Bi.grid.entity:Bi.grid.entity.consumption||Bi.grid.entity.production;this.openDetails(e,t)}}}">${pa(Gi,"grid")}<ha-icon .icon="${Gi.icon}"></ha-icon>${("two_way"===(null===(vi=Bi.grid)||void 0===vi?void 0:vi.display_state)||void 0===(null===(_i=Bi.grid)||void 0===_i?void 0:_i.display_state)||"one_way"===(null===(hi=Bi.grid)||void 0===hi?void 0:hi.display_state)&&(null!==(pi=Gi.state.toGrid)&&void 0!==pi?pi:0)>0||"one_way_no_zero"===(null===(yi=Bi.grid)||void 0===yi?void 0:yi.display_state)&&(null===Gi.state.fromGrid||0===Gi.state.fromGrid)&&0!==Gi.state.toGrid)&&null!==Gi.state.toGrid&&!Gi.powerOutage.isOutage?H`<span class="return" @click="${e=>{const t="string"==typeof Bi.grid.entity?Bi.grid.entity:Bi.grid.entity.production;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Bi.grid.entity?Bi.grid.entity:Bi.grid.entity.production;this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-left"}"></ha-icon>${this.displayValue(Gi.state.toGrid)}</span>`:null} ${("two_way"===(null===(mi=Bi.grid)||void 0===mi?void 0:mi.display_state)||void 0===(null===(fi=Bi.grid)||void 0===fi?void 0:fi.display_state)||"one_way"===(null===(gi=Bi.grid)||void 0===gi?void 0:gi.display_state)&&Gi.state.fromGrid>0||"one_way_no_zero"===(null===(bi=Bi.grid)||void 0===bi?void 0:bi.display_state)&&(null===Gi.state.toGrid||0===Gi.state.toGrid))&&null!==Gi.state.fromGrid&&!Gi.powerOutage.isOutage?H`<span class="consumption"><ha-icon class="small" .icon="${"mdi:arrow-right"}"></ha-icon>${this.displayValue(Gi.state.fromGrid)}</span>`:""} ${Gi.powerOutage.isOutage?H`<span class="grid power-outage">${(null===(wi=Bi.grid)||void 0===wi?void 0:wi.power_outage.label_alert)||H`Power<br>Outage`}</span>`:""}</div><span class="label">${Gi.name}</span></div>`:H`<div class="spacer"></div>`}<div class="circle-container home"><div class="circle" id="home-circle" @click="${e=>{var t;this.openDetails(e,null===(t=Bi.home)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Bi.home)||void 0===t?void 0:t.entity)}}">${pa(Hi,"home")}<ha-icon .icon="${Hi.icon}"></ha-icon>${na} <svg class="home-circle-sections">${void 0!==Qi?L`<circle class="solar" cx="40" cy="40" r="38" stroke-dasharray="${Qi} ${lt-Qi}" shape-rendering="geometricPrecision" stroke-dashoffset="-${lt-Qi}">`:""} ${Ji?L`<circle class="battery" cx="40" cy="40" r="38" stroke-dasharray="${Ji} ${lt-Ji}" stroke-dashoffset="-${lt-Ji-(Qi||0)}" shape-rendering="geometricPrecision">`:""} ${void 0!==Xi?L`<circle class="low-carbon" cx="40" cy="40" r="38" stroke-dasharray="${Xi} ${lt-Xi}" stroke-dashoffset="-${lt-Xi-(Ji||0)-(Qi||0)}" shape-rendering="geometricPrecision">`:""}<circle class="grid" cx="40" cy="40" r="38" stroke-dasharray="${null!=la?la:lt-Qi-(Ji||0)} ${void 0!==la?lt-la:Qi+(Ji||0)}" stroke-dashoffset="0" shape-rendering="geometricPrecision"/></svg></div>${this.showLine(Wi.state||0)&&Vi.has&&Wi.has?"":H`<span class="label">${Hi.name}</span>`}</div></div>${Ui.has||Wi.has&&Vi.has?H`<div class="row"><div class="spacer"></div>${Ui.has?H`<div class="circle-container battery"><div class="circle" @click="${e=>{var t,o,i,a,r;const n=(null===(t=Bi.battery)||void 0===t?void 0:t.state_of_charge)?null===(o=Bi.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof(null===(i=Bi.battery)||void 0===i?void 0:i.entity)?null===(a=Bi.battery)||void 0===a?void 0:a.entity:null===(r=Bi.battery)||void 0===r?void 0:r.entity.production;this.openDetails(e,n)}}" @keyDown="${e=>{var t,o;if("Enter"===e.key){const i=(null===(t=Bi.battery)||void 0===t?void 0:t.state_of_charge)?null===(o=Bi.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof Bi.battery.entity?Bi.battery.entity:Bi.battery.entity.production;this.openDetails(e,i)}}}">${null!==Ui.state_of_charge.state?H`<span @click="${e=>{var t;this.openDetails(e,null===(t=Bi.battery)||void 0===t?void 0:t.state_of_charge)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Bi.battery)||void 0===t?void 0:t.state_of_charge)}}" id="battery-state-of-charge-text">${this.displayValue(Ui.state_of_charge.state,Ui.state_of_charge.unit,Ui.state_of_charge.unit_white_space,Ui.state_of_charge.decimals)}</span>`:null}<ha-icon .icon="${Ui.icon}" style="${"two_way"===(null===(xi=Bi.battery)||void 0===xi?void 0:xi.display_state)?"padding-top: 0px; padding-bottom: 2px;":"one_way"===(null===($i=Bi.battery)||void 0===$i?void 0:$i.display_state)&&0===Ui.state.toBattery&&0===Ui.state.fromBattery?"padding-top: 2px; padding-bottom: 0px;":"padding-top: 2px; padding-bottom: 2px;"}" @click="${e=>{var t;this.openDetails(e,null===(t=Bi.battery)||void 0===t?void 0:t.state_of_charge)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Bi.battery)||void 0===t?void 0:t.state_of_charge)}}"></ha-icon>${"two_way"===(null===(ki=Bi.battery)||void 0===ki?void 0:ki.display_state)||void 0===(null===(Ei=Bi.battery)||void 0===Ei?void 0:Ei.display_state)||"one_way"===(null===(Ci=Bi.battery)||void 0===Ci?void 0:Ci.display_state)&&Ui.state.toBattery>0||"one_way_no_zero"===(null===(Si=Bi.battery)||void 0===Si?void 0:Si.display_state)&&0!==Ui.state.toBattery?H`<span class="battery-in" @click="${e=>{const t="string"==typeof Bi.battery.entity?Bi.battery.entity:Bi.battery.entity.production;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Bi.battery.entity?Bi.battery.entity:Bi.battery.entity.production;this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-down"}"></ha-icon>${this.displayValue(Ui.state.toBattery)}</span>`:""} ${"two_way"===(null===(Ai=Bi.battery)||void 0===Ai?void 0:Ai.display_state)||void 0===(null===(Mi=Bi.battery)||void 0===Mi?void 0:Mi.display_state)||"one_way"===(null===(zi=Bi.battery)||void 0===zi?void 0:zi.display_state)&&Ui.state.fromBattery>0||"one_way_no_zero"===(null===(Di=Bi.battery)||void 0===Di?void 0:Di.display_state)&&(0===Ui.state.toBattery||0!==Ui.state.fromBattery)?H`<span class="battery-out" @click="${e=>{const t="string"==typeof Bi.battery.entity?Bi.battery.entity:Bi.battery.entity.consumption;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Bi.battery.entity?Bi.battery.entity:Bi.battery.entity.consumption;this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-up"}"></ha-icon>${this.displayValue(Ui.state.fromBattery)}</span>`:""}</div><span class="label">${Ui.name}</span></div>`:H`<div class="spacer"></div>`} ${Vi.has&&Wi.has?H`<div class="circle-container individual1 bottom">${this.showLine(Wi.state||0)?H`<svg width="80" height="30"><path d="M40 40 v-40" id="individual1"/>${Wi.state?L`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Pi=Bi.individual1)||void 0===Pi?void 0:Pi.calculate_flow_rate,ta.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${Wi.invertAnimation?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:H`<svg width="80" height="30"></svg>`}<div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Bi.individual1)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Bi.individual1)||void 0===t?void 0:t.entity)}}">${ya(Wi,"individual1")}<ha-icon id="individual1-icon" .icon="${Wi.icon}" style="${Wi.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Ti=Bi.individual1)||void 0===Ti?void 0:Ti.display_zero_state)||(Wi.state||0)>(null!==(ji=Wi.displayZeroTolerance)&&void 0!==ji?ji:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Oi=Bi.individual1)||void 0===Oi?void 0:Oi.display_zero_state)||(Wi.state||0)>(null!==(Ni=Wi.displayZeroTolerance)&&void 0!==Ni?Ni:0)?H`<span class="individual1">${Wi.showDirection?H`<ha-icon class="small" .icon="${Wi.invertAnimation?"mdi:arrow-up":"mdi:arrow-down"}"></ha-icon>`:""}${ia}</span>`:""}</div><span class="label">${Wi.name}</span></div>`:H`<div class="spacer"></div>`}</div>`:H`<div class="spacer"></div>`} ${Ii.has&&this.showLine(Ii.state.toHome||0)?H`<div class="lines ${me({high:Ui.has,"individual1-individual2":!Ui.has&&Vi.has&&Wi.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-home-flow"><path id="solar" class="solar" d="M${Ui.has?55:53},0 v${Gi.has?15:17} c0,${Ui.has?"30 10,30 30,30":"35 10,35 30,35"} h25" vector-effect="non-scaling-stroke"></path>${Ii.state.toHome?L`<circle r="1" class="solar" vector-effect="non-scaling-stroke"><animateMotion dur="${ta.solarToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#solar"></animateMotion></circle>`:""}</svg></div>`:""} ${Gi.hasReturnToGrid&&Ii.has&&this.showLine(Ii.state.toGrid||0)?H`<div class="lines ${me({high:Ui.has,"individual1-individual2":!Ui.has&&Vi.has&&Wi.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-grid-flow"><path id="return" class="return" d="M${Ui.has?45:47},0 v15 c0,${Ui.has?"30 -10,30 -30,30":"35 -10,35 -30,35"} h-20" vector-effect="non-scaling-stroke"></path>${Ii.state.toGrid&&Ii.has?L`<circle r="1" class="return" vector-effect="non-scaling-stroke"><animateMotion dur="${ta.solarToGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#return"></animateMotion></circle>`:""}</svg></div>`:""} ${Ui.has&&Ii.has&&this.showLine(Ii.state.toBattery||0)?H`<div class="lines ${me({high:Ui.has,"individual1-individual2":!Ui.has&&Vi.has&&Wi.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-battery-flow" class="flat-line"><path id="battery-solar" class="battery-solar" d="M50,0 V100" vector-effect="non-scaling-stroke"></path>${Ii.state.toBattery?L`<circle r="1" class="battery-solar" vector-effect="non-scaling-stroke"><animateMotion dur="${ta.solarToBattery}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-solar"></animateMotion></circle>`:""}</svg></div>`:""} ${Gi.has&&this.showLine(Gi.state.fromGrid)?H`<div class="lines ${me({high:Ui.has,"individual1-individual2":!Ui.has&&Vi.has&&Wi.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="grid-home-flow" class="flat-line"><path class="grid" id="grid" d="M0,${Ui.has?50:Ii.has?56:53} H100" vector-effect="non-scaling-stroke"></path>${Gi.state.fromGrid?L`<circle r="1" class="grid" vector-effect="non-scaling-stroke"><animateMotion dur="${ta.gridToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#grid"></animateMotion></circle>`:""}</svg></div>`:null} ${Ui.has&&this.showLine(Ui.state.fromBattery)?H`<div class="lines ${me({high:Ui.has,"individual1-individual2":!Ui.has&&Vi.has&&Wi.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-home-flow"><path id="battery-home" class="battery-home" d="M55,100 v-${Gi.has?15:17} c0,-30 10,-30 30,-30 h20" vector-effect="non-scaling-stroke"></path>${Ui.state.fromBattery?L`<circle r="1" class="battery-home" vector-effect="non-scaling-stroke"><animateMotion dur="${ta.batteryToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-home"></animateMotion></circle>`:""}</svg></div>`:""} ${Gi.has&&Ui.has&&this.showLine(Math.max(Gi.state.toBattery||0,Ui.state.toGrid||0))?H`<div class="lines ${me({high:Ui.has,"individual1-individual2":!Ui.has&&Vi.has&&Wi.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-grid-flow"><path id="battery-grid" class="${me({"battery-from-grid":Boolean(Gi.state.toBattery),"battery-to-grid":Boolean(Ui.state.toGrid)})}" d="M45,100 v-15 c0,-30 -10,-30 -30,-30 h-20" vector-effect="non-scaling-stroke"></path>${Gi.state.toBattery?L`<circle r="1" class="battery-from-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${ta.batteryGrid}s" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""} ${Ui.state.toGrid?L`<circle r="1" class="battery-to-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${ta.batteryGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""}</svg></div>`:""}</div>${this._config.dashboard_link?H`<div class="card-actions"><a href="${this._config.dashboard_link}"><mwc-button>${this._config.dashboard_link_label||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.go_to_energy_dashboard")}</mwc-button></a></div>`:""}</ha-card>`}updated(e){var t;if(super.updated(e),!this._config||!this.hass)return;const o=null===(t=null==this?void 0:this.shadowRoot)||void 0===t?void 0:t.querySelector("#power-flow-card-plus"),i=o?getComputedStyle(o).getPropertyValue("width"):"0px";this._width=parseInt(i.replace("px",""),10),this._tryConnectAll()}_tryConnectAll(){var e,t,o,i,a,r,n,l,s,d,c,u;const{entities:v}=this._config,_={gridSecondary:null===(t=null===(e=v.grid)||void 0===e?void 0:e.secondary_info)||void 0===t?void 0:t.template,solarSecondary:null===(i=null===(o=v.solar)||void 0===o?void 0:o.secondary_info)||void 0===i?void 0:i.template,homeSecondary:null===(r=null===(a=v.home)||void 0===a?void 0:a.secondary_info)||void 0===r?void 0:r.template,individual1Secondary:null===(l=null===(n=v.individual1)||void 0===n?void 0:n.secondary_info)||void 0===l?void 0:l.template,individual2Secondary:null===(d=null===(s=v.individual2)||void 0===s?void 0:s.secondary_info)||void 0===d?void 0:d.template,nonFossilFuelSecondary:null===(u=null===(c=v.fossil_fuel_percentage)||void 0===c?void 0:c.secondary_info)||void 0===u?void 0:u.template};for(const[e,t]of Object.entries(_))t&&this._tryConnect(t,e)}async _tryConnect(e,t){var o,i,a,r,n,l;if(this.hass&&this._config&&void 0===(null===(o=this._unsubRenderTemplates)||void 0===o?void 0:o.get(t))&&""!==e)try{const o=(r=this.hass.connection,n=e=>{this._templateResults[t]=e},l={template:e,entity_ids:this._config.entity_id,variables:{config:this._config,user:this.hass.user.name},strict:!0},r.subscribeMessage((e=>n(e)),Object.assign({type:"render_template"},l)));null===(i=this._unsubRenderTemplates)||void 0===i||i.set(t,o),await o}catch(o){this._templateResults=Object.assign(Object.assign({},this._templateResults),{[t]:{result:e,listeners:{all:!1,domains:[],entities:[],time:!1}}}),null===(a=this._unsubRenderTemplates)||void 0===a||a.delete(t)}}async _tryDisconnectAll(){var e,t,o,i,a,r,n,l,s,d;const{entities:c}=this._config,u={gridSecondary:null===(t=null===(e=c.grid)||void 0===e?void 0:e.secondary_info)||void 0===t?void 0:t.template,solarSecondary:null===(i=null===(o=c.solar)||void 0===o?void 0:o.secondary_info)||void 0===i?void 0:i.template,homeSecondary:null===(r=null===(a=c.home)||void 0===a?void 0:a.secondary_info)||void 0===r?void 0:r.template,individual1Secondary:null===(l=null===(n=c.individual1)||void 0===n?void 0:n.secondary_info)||void 0===l?void 0:l.template,individual2Secondary:null===(d=null===(s=c.individual2)||void 0===s?void 0:s.secondary_info)||void 0===d?void 0:d.template};for(const[e,t]of Object.entries(u))t&&this._tryDisconnect(e)}async _tryDisconnect(e){var t,o;const i=null===(t=this._unsubRenderTemplates)||void 0===t?void 0:t.get(e);if(i)try{(await i)(),null===(o=this._unsubRenderTemplates)||void 0===o||o.delete(e)}catch(e){if("not_found"!==e.code&&"template_error"!==e.code)throw e}}};st.styles=$e,e([ve({attribute:!1})],st.prototype,"hass",void 0),e([_e()],st.prototype,"_config",void 0),e([_e()],st.prototype,"_templateResults",void 0),e([_e()],st.prototype,"_unsubRenderTemplate",void 0),e([_e()],st.prototype,"_unsubRenderTemplates",void 0),e([_e()],st.prototype,"_width",void 0),e([he("#battery-grid-flow")],st.prototype,"batteryGridFlow",void 0),e([he("#battery-home-flow")],st.prototype,"batteryToHomeFlow",void 0),e([he("#grid-home-flow")],st.prototype,"gridToHomeFlow",void 0),e([he("#solar-battery-flow")],st.prototype,"solarToBatteryFlow",void 0),e([he("#solar-grid-flow")],st.prototype,"solarToGridFlow",void 0),e([he("#solar-home-flow")],st.prototype,"solarToHomeFlow",void 0),st=e([ce("power-flow-card-plus")],st);class dt extends TypeError{constructor(e,t){let o;const{message:i,explanation:a,...r}=e,{path:n}=e,l=0===n.length?i:`At path: ${n.join(".")} -- ${i}`;super(a??l),null!=a&&(this.cause=l),Object.assign(this,r),this.name=this.constructor.name,this.failures=()=>o??(o=[e,...t()])}}function ct(e){return"object"==typeof e&&null!=e}function ut(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function vt(e,t,o,i){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:a,branch:r}=t,{type:n}=o,{refinement:l,message:s=`Expected a value of type \`${n}\`${l?` with refinement \`${l}\``:""}, but received: \`${ut(i)}\``}=e;return{value:i,type:n,refinement:l,key:a[a.length-1],path:a,branch:r,...e,message:s}}function*_t(e,t,o,i){(function(e){return ct(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const a of e){const e=vt(a,t,o,i);e&&(yield e)}}function*ht(e,t,o={}){const{path:i=[],branch:a=[e],coerce:r=!1,mask:n=!1}=o,l={path:i,branch:a};if(r&&(e=t.coercer(e,l),n&&"type"!==t.type&&ct(t.schema)&&ct(e)&&!Array.isArray(e)))for(const o in e)void 0===t.schema[o]&&delete e[o];let s="valid";for(const i of t.validator(e,l))i.explanation=o.message,s="not_valid",yield[i,void 0];for(let[d,c,u]of t.entries(e,l)){const t=ht(c,u,{path:void 0===d?i:[...i,d],branch:void 0===d?a:[...a,c],coerce:r,mask:n,message:o.message});for(const o of t)o[0]?(s=null!=o[0].refinement?"not_refined":"not_valid",yield[o[0],void 0]):r&&(c=o[1],void 0===d?e=c:e instanceof Map?e.set(d,c):e instanceof Set?e.add(c):ct(e)&&(void 0!==c||d in e)&&(e[d]=c))}if("not_valid"!==s)for(const i of t.refiner(e,l))i.explanation=o.message,s="not_refined",yield[i,void 0];"valid"===s&&(yield[void 0,e])}class pt{constructor(e){const{type:t,schema:o,validator:i,refiner:a,coercer:r=(e=>e),entries:n=function*(){}}=e;this.type=t,this.schema=o,this.entries=n,this.coercer=r,this.validator=i?(e,t)=>_t(i(e,t),t,this,e):()=>[],this.refiner=a?(e,t)=>_t(a(e,t),t,this,e):()=>[]}assert(e,t){return yt(e,this,t)}create(e,t){return function(e,t,o){const i=mt(e,t,{coerce:!0,message:o});if(i[0])throw i[0];return i[1]}(e,this,t)}is(e){return function(e,t){return!mt(e,t)[0]}(e,this)}mask(e,t){return function(e,t,o){const i=mt(e,t,{coerce:!0,mask:!0,message:o});if(i[0])throw i[0];return i[1]}(e,this,t)}validate(e,t={}){return mt(e,this,t)}}function yt(e,t,o){const i=mt(e,t,{message:o});if(i[0])throw i[0]}function mt(e,t,o={}){const i=ht(e,t,o),a=function(e){const{done:t,value:o}=e.next();return t?void 0:o}(i);if(a[0]){return[new dt(a[0],(function*(){for(const e of i)e[0]&&(yield e[0])})),void 0]}return[void 0,a[1]]}function ft(e,t){return new pt({type:e,schema:null,validator:t})}function gt(){return ft("any",(()=>!0))}function bt(){return ft("boolean",(e=>"boolean"==typeof e))}function wt(){return ft("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${ut(e)}`))}function xt(){return ft("number",(e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${ut(e)}`))}function $t(e){const t=e?Object.keys(e):[],o=ft("never",(()=>!1));return new pt({type:"object",schema:e||null,*entries(i){if(e&&ct(i)){const a=new Set(Object.keys(i));for(const o of t)a.delete(o),yield[o,i[o],e[o]];for(const e of a)yield[e,i[e],o]}},validator:e=>ct(e)||`Expected an object, but received: ${ut(e)}`,coercer:e=>ct(e)?{...e}:e})}function kt(e){return new pt({...e,validator:(t,o)=>void 0===t||e.validator(t,o),refiner:(t,o)=>void 0===t||e.refiner(t,o)})}function Et(){return ft("string",(e=>"string"==typeof e||`Expected a string, but received: ${ut(e)}`))}var Ct=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function St(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!((i=e[o])===(a=t[o])||Ct(i)&&Ct(a)))return!1;var i,a;return!0}function At(e,t){void 0===t&&(t=St);var o=null;function i(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(o&&o.lastThis===this&&t(i,o.lastArgs))return o.lastResult;var r=e.apply(this,i);return o={lastResult:r,lastArgs:i,lastThis:this},r}return i.clear=function(){o=null},i}function Mt(){return{type:"expandable",title:nt("editor.combined"),schema:[{name:"entity",selector:{entity:{}}}]}}function zt(){return{type:"expandable",title:nt("editor.separated"),name:"entity",schema:[{name:"consumption",label:"Consumption Entity",selector:{entity:{}}},{name:"production",label:"Production Entity",selector:{entity:{}}}]}}const Dt={name:"color",title:nt("editor.custom_colors"),type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"consumption",label:"Consumption",selector:{color_rgb:{}}},{name:"production",label:"Production",selector:{color_rgb:{}}}]}]},Pt=[{name:"entity",selector:{entity:{}}},{name:"template",label:"Template (overrides entity, save to update)",selector:{template:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"icon",selector:{icon:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}}]}],Tt=[{name:"color_icon",label:"Color of Icon",selector:{select:{options:[{value:!1,label:"Do not Color"},{value:!0,label:"Color dynamically"},{value:"production",label:"Production"},{value:"consumption",label:"Consumption"}],custom_value:!0}}},{name:"color_circle",label:"Color of Circle",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{min:0,max:1e6,step:1,mode:"box"}}},{name:"display_state",label:"Display State",selector:{select:{options:[{value:"two_way",label:"Two Way"},{value:"one_way",label:"One Way"},{value:"one_way_no_zero",label:"One Way (Show Zero)"}],custom_value:!0}}}];function jt(e){const t={type:"grid",column_min_width:"200px",schema:[{name:"name",selector:{text:{}}},{name:"icon",selector:{icon:{}}}]};return"battery"!==e&&"grid"!==e||t.schema.push(...Tt),t}const Ot=Object.assign(Object.assign({},jt("grid")),{schema:[...jt("grid").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),Nt=[Mt(),zt(),Ot,Dt,{title:nt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Pt},{title:nt("editor.power_outage"),name:"power_outage",type:"expandable",schema:[{name:"entity",selector:{entity:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"label_alert",label:"Outage Label",selector:{text:{}}},{name:"icon_alert",label:"Outage Icon",selector:{icon:{}}},{name:"state_alert",label:"Outage State",selector:{text:{}}}]}]}],Bt=Object.assign(Object.assign({},jt("battery")),{schema:[...jt("battery").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),Rt=[Mt(),zt(),{title:nt("editor.state_of_charge"),name:"",type:"expandable",schema:[{name:"state_of_charge",label:"State of Charge Entity",selector:{entity:{}}},{name:"",type:"grid",column_min_width:"200px",schema:[{name:"state_of_charge_unit",label:"Unit",selector:{text:{}}},{name:"state_of_charge_unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"state_of_charge_decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"color_state_of_charge_value",label:"Color of Value",selector:{select:{options:[{value:!1,label:"Do Not Color"},{value:!0,label:"Color dynamically"},{value:"consumption",label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}}]}]},Bt,Dt],Ft=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero_state",label:"Display State When Zero?",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:nt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Pt}],Gt=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"calculate_flow_rate",label:"Calculate Flow Rate",selector:{boolean:{}}},{name:"decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"inverted_animation",label:"Invert Animation",selector:{boolean:{}}},{name:"show_direction",label:"Show Direction",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:nt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Pt}],It=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"state_type",label:"State Type",selector:{select:{options:[{value:"power",label:"Power"},{value:"percentage",label:"Percentage"}],custom_value:!0}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:nt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Pt}],Ut=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"color_value",label:"Color Value",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"color_icon",label:"Color Icon",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"subtract_individual",label:"Subtract Individual",selector:{boolean:{}}},{name:"override_state",label:"Override State (With Home Entity)",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{title:nt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Pt}],Ht=function(...e){const t="type"===e[0].type,o=e.map((e=>e.schema)),i=Object.assign({},...o);return t?function(e){const t=Object.keys(e);return new pt({type:"type",schema:e,*entries(o){if(ct(o))for(const i of t)yield[i,o[i],e[i]]},validator:e=>ct(e)||`Expected an object, but received: ${ut(e)}`,coercer:e=>ct(e)?{...e}:e})}(i):$t(i)}($t({type:Et(),view_layout:gt()}),$t({title:kt(Et()),theme:kt(Et()),dashboard_link:kt(Et()),dashboard_link_label:kt(Et()),inverted_entities:kt(gt()),w_decimals:kt(wt()),kw_decimals:kt(wt()),min_flow_rate:kt(xt()),max_flow_rate:kt(xt()),min_expected_power:kt(xt()),max_expected_power:kt(xt()),watt_threshold:kt(xt()),clickable_entities:kt(bt()),display_zero_lines:kt(bt()),use_new_flow_rate_model:kt(bt()),entities:$t({battery:kt(gt()),grid:kt(gt()),solar:kt(gt()),home:kt(gt()),fossil_fuel_percentage:kt(gt()),individual1:kt(gt()),individual2:kt(gt())})})),Lt=[{name:"title",label:"Title",selector:{text:{}}}],Wt=At((e=>[{name:"entities",type:"grid",column_min_width:"400px",schema:[{title:e("editor.grid"),name:"grid",type:"expandable",schema:Nt},{title:e("editor.solar"),name:"solar",type:"expandable",schema:Ft},{title:e("editor.battery"),name:"battery",type:"expandable",schema:Rt},{title:e("editor.fossil_fuel_percentage"),name:"fossil_fuel_percentage",type:"expandable",schema:It},{title:e("editor.home"),name:"home",type:"expandable",schema:Ut},{title:`${e("editor.individual")} 1`,name:"individual1",type:"expandable",schema:Gt},{title:`${e("editor.individual")} 2`,name:"individual2",type:"expandable",schema:Gt}]}])),Vt=At((e=>[{title:e("editor.advanced"),type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"dashboard_link",label:"Dashboard Link",selector:{navigation:{}}},{name:"dashboard_link_label",label:"Dashboard Link Label",selector:{text:{}}},{name:"w_decimals",label:"Watt Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"kw_decimals",label:"kW Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"max_flow_rate",label:"Max Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_flow_rate",label:"Min Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"max_expected_power",label:"Max Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_expected_power",label:"Min Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"watt_threshold",label:"Watt to Kilowatt Threshold",selector:{number:{mode:"box",min:0,max:1e6,step:1}}},{name:"display_zero_lines",label:"Display Zero Lines",selector:{boolean:{}}},{name:"clickable_entities",label:"Clickable Entities",selector:{boolean:{}}},{name:"use_new_flow_rate_model",label:"New Flow Model?",selector:{boolean:{}}}]}]}])),Zt=async()=>{var e,t;if(customElements.get("ha-form"))return;const o=await(null===(t=(e=window).loadCardHelpers)||void 0===t?void 0:t.call(e));if(!o)return;const i=await o.createCardElement({type:"entity"});i&&await i.getConfigElement()};let Kt=class extends se{constructor(){super(...arguments),this.showOther=!1,this._computeLabelCallback=e=>this.hass.localize(`ui.panel.lovelace.editor.card.generic.${null==e?void 0:e.name}`)||nt(`editor.${null==e?void 0:e.name}`)}async setConfig(e){yt(e,Ht),this._config=e}connectedCallback(){super.connectedCallback(),Zt()}render(){if(!this.hass||!this._config)return V;const e=Object.assign({},this._config);return H`<div class="card-config"><ha-form .hass="${this.hass}" .data="${e}" .schema="${Lt}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${e}" .schema="${Wt(nt)}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}" class="entities-section"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${e}" .schema="${Vt(nt)}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form></div>`}_valueChanged(e){const t=e.detail.value||"";this._config&&this.hass&&function(e,t,o,i){i=i||{},o=null==o?{}:o;var a=new Event("config-changed",{bubbles:void 0===i.bubbles||i.bubbles,cancelable:Boolean(i.cancelable),composed:void 0===i.composed||i.composed});a.detail=o,e.dispatchEvent(a)}(this,0,{config:t})}static get styles(){return u`ha-form{width:100%}ha-icon-button{align-self:center}.entities-section *{background-color:red}.card-config{display:flex;flex-direction:column;justify-content:space-between;align-items:center;margin-bottom:10px}.config-header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.config-header.sub-header{margin-top:24px}ha-icon{padding-bottom:2px;position:relative;top:-4px;right:1px}`}};e([ve({attribute:!1})],Kt.prototype,"hass",void 0),e([_e()],Kt.prototype,"_config",void 0),e([_e()],Kt.prototype,"showOther",void 0),Kt=e([ce("power-flow-card-plus-editor")],Kt);var Yt=Object.freeze({__proto__:null,loadHaForm:Zt,get PowerFlowCardPlusEditor(){return Kt}});export{st as PowerFlowCardPlus};
